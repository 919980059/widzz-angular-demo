!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"2FIM":function(t,i,a){"use strict";a.r(i),a.d(i,"EditStrategyModule",(function(){return Kt}));var c=a("8STC"),o=a("VphZ"),s=a("g1Xn"),r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),l=new Uint8Array(16);function d(){if(!r)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(l)}for(var g=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,u=function(e){return"string"==typeof e&&g.test(e)},h=[],p=0;p<256;++p)h.push((p+256).toString(16).substr(1));var m,f,b=function(e,t,n){var i=(e=e||{}).random||(e.rng||d)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=i[a];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase();if(!u(n))throw TypeError("Stringified UUID is invalid");return n}(i)},A=a("3Pt+"),y=a("XNiG"),v=JSON.parse,w=JSON.stringify,k=Object.keys,E=String,G=function(e,t){return t},T=function(e){return e instanceof E?E(e):e},S=function(e,t){return"string"==typeof t?new E(t):t},M=function(e,t,n){var i=E(t.push(n)-1);return e.set(n,i),i},x=function(e,t){var n=v(e,S).map(T),i=n[0],a=t||G,c="object"==typeof i&&i?function e(t,n,i,a){return k(i).reduce((function(i,c){var o=i[c];if(o instanceof E){var s=t[o];"object"!=typeof s||n.has(s)?i[c]=a.call(i,c,s):(n.add(s),i[c]=a.call(i,c,e(t,n,s,a)))}else i[c]=a.call(i,c,o);return i}),i)}(n,new Set,i,a):i;return a.call({"":c},"",c)},I=function(e,t,n){for(var i=t&&"object"==typeof t?function(e,n){return""===e||-1<t.indexOf(e)?n:void 0}:t||G,a=new Map,c=[],o=[],s=+M(a,c,i.call({"":e},"",e)),r=!s;s<c.length;)r=!0,o[s]=w(c[s++],l,n);return"["+o.join(",")+"]";function l(e,t){if(r)return r=!r,t;var n=i.call(this,e,t);switch(typeof n){case"object":if(null===n)return n;case"string":return a.get(n)||M(a,c,n)}return n}},N=a("4yoF"),Y=a("fXoL"),C=a("O1s9"),L=a("0IaG"),U=a("tk/3"),R=a("Y8gI"),Z=a("tyNb"),D=a("sYmb"),F=a("dNgK"),X=a("BMBm"),J=a("YMqD"),j=((f=function(){function t(n,i){e(this,t),this.http=n,this.utils=i}return n(t,[{key:"multiSearchMemberLists",value:function(e,t,n,i){var a=this.utils.getMultiSearch(e,t,n,i);return this.http.get(sessionStorage.getItem("baseUrl")+X.a.passengersTag+a,{observe:"response"})}},{key:"getDetailById",value:function(e){return this.http.get(sessionStorage.getItem("baseUrl")+X.a.passengersTag+"/"+e)}}]),t}()).\u0275fac=function(e){return new(e||f)(Y.cc(U.c),Y.cc(J.a))},f.\u0275prov=Y.Ob({token:f,factory:f.\u0275fac,providedIn:"root"}),f),Q=((m=function(){function t(n,i){e(this,t),this.http=n,this.utils=i}return n(t,[{key:"getCouponById",value:function(e){return this.http.get(sessionStorage.getItem("baseUrl")+e)}}]),t}()).\u0275fac=function(e){return new(e||m)(Y.cc(U.c),Y.cc(J.a))},m.\u0275prov=Y.Ob({token:m,factory:m.\u0275fac,providedIn:"root"}),m),B=a("+IAj"),V=a("XiUz"),P=a("ofXK"),O=a("bTqV"),W=a("FKr1"),z=a("Qu3c"),H=a("NFeN"),K=a("f0Cb"),q=a("znSr"),_=a("kmnG"),$=a("qFsG"),ee=a("3BxJ"),te=a("zwY0"),ne=a.n(te),ie=a("Ombb"),ae=a("QM5T"),ce=a("4bjS"),oe=a("XQXX"),se=["input"];function re(e,t){if(1&e&&(Y.Yb(0,"mat-label"),Y.Uc(1),Y.Xb()),2&e){var n=Y.kc();Y.Gb(1),Y.Vc(n.label)}}function le(e,t){1&e&&Y.Tb(0,"span",5)}function de(e,t){if(1&e&&(Y.Yb(0,"mat-error"),Y.Uc(1),Y.Xb()),2&e){var n=Y.kc();Y.Gb(1),Y.Vc(n.requiredMsg)}}var ge,ue,he=new Y.t("default_lang"),pe=((ue=function(){function t(n){e(this,t),this.defaultLang=n,this.readonly=!0,this.showCalendar=!0,this.floatLabel="auto",this.config={enableTime:!0,time_24hr:!0,enableSeconds:!0},this.timeControl=new A.e,this.sourceDate=new Y.o,this.inputValue=new Y.o}return n(t,[{key:"setDateLocale",value:function(e){switch(e){case"zh-CN":this.config.locale=ee.Mandarin;break;case"zh-TW":this.config.locale=ie.MandarinTraditional;break;default:this.config.locale=ae.english}this.picker&&this.picker.destroy(),this.picker=ne()(this.input.nativeElement,this.config)}},{key:"onDateChange",value:function(e){var t=this;this.sourceDate.emit(this.picker.selectedDates[0]),setTimeout((function(){t.inputValue.emit(e.target.value)}),500)}},{key:"ngOnInit",value:function(){var e=this;this.setDateLocale(this.defaultLang),this.timeControl.valueChanges.subscribe((function(t){if("Invalid Date"!==new Date(t).toString()&&e.picker.setDate(new Date(t),!1),null===t&&e.picker.setDate(null,!1),e.isTime(t)){var n=t.split(":"),i=Object(ce.a)(Object(oe.a)(new Date,Number(n[0])),Number(n[1]));e.picker.setDate(i,!1)}}))}},{key:"isTime",value:function(e){return/^[0-9a-zA-Z]{1,2}[:][0-9]{1,2}$/.test(e)}},{key:"ngOnDestroy",value:function(){this.picker.destroy()}}]),t}()).\u0275fac=function(e){return new(e||ue)(Y.Sb(he,8))},ue.\u0275cmp=Y.Mb({type:ue,selectors:[["lib-ng-material-flatpickr"]],viewQuery:function(e,t){var n;1&e&&Y.Oc(se,!0),2&e&&Y.Ec(n=Y.hc())&&(t.input=n.first)},inputs:{readonly:"readonly",showCalendar:"showCalendar",floatLabel:"floatLabel",config:"config",timeControl:"timeControl",label:"label",requiredMsg:"requiredMsg"},outputs:{sourceDate:"sourceDate",inputValue:"inputValue"},decls:6,vars:6,consts:[["appearance","outline",3,"floatLabel"],[4,"ngIf"],["autocomplete","off","matInput","",3,"readonly","formControl","change"],["input",""],["class","iconfont iconcalendar","matSuffix","",4,"ngIf"],["matSuffix","",1,"iconfont","iconcalendar"]],template:function(e,t){1&e&&(Y.Yb(0,"mat-form-field",0),Y.Sc(1,re,2,1,"mat-label",1),Y.Yb(2,"input",2,3),Y.gc("change",(function(e){return t.onDateChange(e)})),Y.Xb(),Y.Sc(4,le,1,0,"span",4),Y.Sc(5,de,2,1,"mat-error",1),Y.Xb()),2&e&&(Y.sc("floatLabel",t.floatLabel),Y.Gb(1),Y.sc("ngIf",t.label),Y.Gb(1),Y.sc("readonly",t.readonly)("formControl",t.timeControl),Y.Gb(2),Y.sc("ngIf",t.showCalendar),Y.Gb(1),Y.sc("ngIf",t.timeControl.invalid&&t.timeControl.hasError("required")))},directives:[_.c,P.n,$.b,A.c,A.o,A.f,_.f,_.h,_.b],encapsulation:2}),ue),me=((ge=function(){function t(){e(this,t)}return n(t,null,[{key:"forRoot",value:function(e){return{ngModule:t,providers:[{provide:he,useValue:e}]}}}]),t}()).\u0275mod=Y.Qb({type:ge}),ge.\u0275inj=Y.Pb({factory:function(e){return new(e||ge)},imports:[[_.e,$.c,P.c,A.s]]}),ge),fe=a("1jcm"),be=a("ihCf"),Ae=a("A5z7"),ye=a("CPJB"),ve=a("8vh+"),we=a("Bone"),ke=a("zkxU"),Ee=a("CSEJ"),Ge=["clearCanvas"],Te=["canLeave"],Se=["textInput"],Me=["startTime"],xe=["endTime"];function Ie(e,t){1&e&&(Y.Yb(0,"h2",61),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e&&(Y.Gb(1),Y.Vc(Y.mc(2,1,"nav.marketingStrategy.edit")))}function Ne(e,t){1&e&&(Y.Yb(0,"h2",61),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e&&(Y.Gb(1),Y.Vc(Y.mc(2,1,"nav.marketingStrategy.create")))}function Ye(e,t){if(1&e&&(Y.jc(),Y.Yb(0,"tspan",71),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc().$implicit;Y.Gb(1),Y.Wc(" ",Y.mc(2,1,n.name)," ")}}function Ce(e,t){if(1&e&&(Y.jc(),Y.Yb(0,"tspan",72),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc().$implicit;Y.Gb(1),Y.Wc(" ",Y.mc(2,1,n.name)," ")}}function Le(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",62),Y.gc("touchmove",(function(e){return Y.Jc(n),Y.kc().onTouchMove(e)}))("touchend",(function(e){return Y.Jc(n),Y.kc().onTouchEnd(e)}))("touchstart",(function(e){return Y.Jc(n),Y.kc().onTouchStart(e)}))("dragstart",(function(e){return Y.Jc(n),Y.kc().onDragStart(e)})),Y.lc(1,"translate"),Y.jc(),Y.Yb(2,"svg",63),Y.Tb(3,"rect",64),Y.Tb(4,"circle",65),Y.Tb(5,"circle",66),Y.Yb(6,"text",67),Y.Yb(7,"tspan",68),Y.Uc(8),Y.Xb(),Y.Yb(9,"tspan",68),Y.Uc(10),Y.Xb(),Y.Sc(11,Ye,3,3,"tspan",69),Y.lc(12,"translate"),Y.Sc(13,Ce,3,3,"tspan",70),Y.lc(14,"translate"),Y.Xb(),Y.Xb(),Y.Xb()}if(2&e){var i=t.$implicit;Y.sc("id",i.type)("title",Y.mc(1,6,i.belongType)),Y.Gb(8),Y.Vc(i.type),Y.Gb(2),Y.Vc(i.name),Y.Gb(1),Y.sc("ngIf",Y.mc(12,8,i.name).length<=5),Y.Gb(2),Y.sc("ngIf",Y.mc(14,10,i.name).length>5)}}function Ue(e,t){if(1&e&&(Y.jc(),Y.Yb(0,"tspan",71),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc().$implicit;Y.Gb(1),Y.Wc(" ",Y.mc(2,1,n.name)," ")}}function Re(e,t){if(1&e&&(Y.jc(),Y.Yb(0,"tspan",72),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc().$implicit;Y.Gb(1),Y.Wc(" ",Y.mc(2,1,n.name)," ")}}function Ze(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",73),Y.gc("touchmove",(function(e){return Y.Jc(n),Y.kc().onTouchMove(e)}))("touchend",(function(e){return Y.Jc(n),Y.kc().onTouchEnd(e)}))("touchstart",(function(e){return Y.Jc(n),Y.kc().onTouchStart(e)}))("dragstart",(function(e){return Y.Jc(n),Y.kc().onDragStart(e)})),Y.lc(1,"translate"),Y.jc(),Y.Yb(2,"svg",63),Y.Tb(3,"rect",74),Y.Tb(4,"circle",65),Y.Tb(5,"circle",75),Y.Yb(6,"text",67),Y.Yb(7,"tspan",68),Y.Uc(8),Y.Xb(),Y.Yb(9,"tspan",68),Y.Uc(10),Y.Xb(),Y.Sc(11,Ue,3,3,"tspan",69),Y.lc(12,"translate"),Y.Sc(13,Re,3,3,"tspan",70),Y.lc(14,"translate"),Y.Xb(),Y.Xb(),Y.Xb()}if(2&e){var i=t.$implicit;Y.sc("id",i.type)("title",Y.mc(1,6,i.belongType)),Y.Gb(8),Y.Vc(i.type),Y.Gb(2),Y.Vc(i.name),Y.Gb(1),Y.sc("ngIf",Y.mc(12,8,i.name).length<=5),Y.Gb(2),Y.sc("ngIf",Y.mc(14,10,i.name).length>5)}}function De(e,t){if(1&e&&(Y.jc(),Y.Yb(0,"tspan",71),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc().$implicit;Y.Gb(1),Y.Wc(" ",Y.mc(2,1,n.name)," ")}}function Fe(e,t){if(1&e&&(Y.jc(),Y.Yb(0,"tspan",72),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc().$implicit;Y.Gb(1),Y.Wc(" ",Y.mc(2,1,n.name)," ")}}function Xe(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",76),Y.gc("touchmove",(function(e){return Y.Jc(n),Y.kc().onTouchMove(e)}))("touchend",(function(e){return Y.Jc(n),Y.kc().onTouchEnd(e)}))("touchstart",(function(e){return Y.Jc(n),Y.kc().onTouchStart(e)}))("dragstart",(function(e){return Y.Jc(n),Y.kc().onDragStart(e)})),Y.lc(1,"translate"),Y.jc(),Y.Yb(2,"svg",63),Y.Tb(3,"rect",77),Y.Tb(4,"circle",65),Y.Tb(5,"circle",75),Y.Yb(6,"text",67),Y.Yb(7,"tspan",68),Y.Uc(8),Y.Xb(),Y.Yb(9,"tspan",68),Y.Uc(10),Y.Xb(),Y.Sc(11,De,3,3,"tspan",69),Y.lc(12,"translate"),Y.Sc(13,Fe,3,3,"tspan",70),Y.lc(14,"translate"),Y.Xb(),Y.Xb(),Y.Xb()}if(2&e){var i=t.$implicit;Y.sc("id",i.type)("title",Y.mc(1,6,i.belongType)),Y.Gb(8),Y.Vc(i.type),Y.Gb(2),Y.Vc(i.name),Y.Gb(1),Y.sc("ngIf",Y.mc(12,8,i.name).length<=5),Y.Gb(2),Y.sc("ngIf",Y.mc(14,10,i.name).length>5)}}function Je(e,t){if(1&e){var n=Y.Zb();Y.Wb(0),Y.Yb(1,"button",22),Y.gc("click",(function(){return Y.Jc(n),Y.kc().saveSvg()})),Y.lc(2,"translate"),Y.Yb(3,"mat-icon"),Y.Uc(4,"photo"),Y.Xb(),Y.Xb(),Y.Yb(5,"button",22),Y.gc("click",(function(){return Y.Jc(n),Y.kc().saveJson()})),Y.lc(6,"translate"),Y.Yb(7,"mat-icon"),Y.Uc(8,"cloud_download"),Y.Xb(),Y.Xb(),Y.Vb()}2&e&&(Y.Gb(1),Y.sc("matTooltip",Y.mc(2,2,"strategy.saveSvg")),Y.Gb(4),Y.sc("matTooltip",Y.mc(6,4,"strategy.saveJson")))}function je(e,t){if(1&e&&(Y.Yb(0,"span",78),Y.Uc(1),Y.Xb()),2&e){var n=Y.kc();Y.Gb(1),Y.Xc(" ",n.targetNode.title?"\u201c"+n.targetNode.title+"\u201d":"","",n.errorMsg," ")}}function Qe(e,t){1&e&&(Y.Yb(0,"mat-icon"),Y.Uc(1,"fullscreen"),Y.Xb())}function Be(e,t){1&e&&(Y.Yb(0,"mat-icon"),Y.Uc(1,"fullscreen_exit"),Y.Xb())}function Ve(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"button",22),Y.gc("click",(function(){return Y.Jc(n),Y.kc().reloadStrategy()})),Y.lc(1,"translate"),Y.Yb(2,"mat-icon"),Y.Uc(3,"autorenew"),Y.Xb(),Y.Xb()}2&e&&Y.sc("matTooltip",Y.mc(1,1,"strategy.reload"))}function Pe(e,t){if(1&e){var n=Y.Zb();Y.Wb(0),Y.Yb(1,"button",22),Y.gc("click",(function(){return Y.Jc(n),Y.kc().clearAll()})),Y.lc(2,"translate"),Y.Yb(3,"mat-icon"),Y.Uc(4,"refresh"),Y.Xb(),Y.Xb(),Y.Vb()}2&e&&(Y.Gb(1),Y.sc("matTooltip",Y.mc(2,1,"strategy.clear")))}function Oe(e,t){1&e&&(Y.Yb(0,"mat-error"),Y.Uc(1),Y.lc(2,"translate"),Y.lc(3,"translate"),Y.Xb()),2&e&&(Y.Gb(1),Y.Xc(" ",Y.mc(2,2,"strategy.name"),"",Y.mc(3,4,"form.required")," "))}function We(e,t){if(1&e){var n=Y.Zb();Y.Wb(0),Y.Yb(1,"div",89),Y.gc("click",(function(){Y.Jc(n);var e=t.$implicit;return Y.kc(3).appendNode(e)})),Y.lc(2,"translate"),Y.jc(),Y.Yb(3,"svg",90),Y.Tb(4,"circle",91),Y.Xb(),Y.Xb(),Y.Vb()}if(2&e){var i=t.$implicit;Y.Gb(1),Y.sc("id","line-"+i.type)("matTooltip",Y.mc(2,2,i.name))}}function ze(e,t){if(1&e&&(Y.Yb(0,"div",82),Y.Sc(1,We,5,4,"ng-container",88),Y.Xb()),2&e){var n=Y.kc(2);Y.Gb(1),Y.sc("ngForOf",n.editControls)}}function He(e,t){1&e&&Y.Tb(0,"mat-divider",16)}function Ke(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",86),Y.gc("click",(function(){return Y.Jc(n),Y.kc(2).showChangeTypes()})),Y.lc(1,"translate"),Y.Yb(2,"mat-icon",87),Y.Uc(3,"build"),Y.Xb(),Y.Xb()}2&e&&Y.sc("matTooltip",Y.mc(1,1,"strategy.changeType"))}function qe(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",92),Y.gc("click",(function(){return Y.Jc(n),Y.kc(2).lineNode()})),Y.lc(1,"translate"),Y.Yb(2,"mat-icon",87),Y.Uc(3,"arrow_right_alt"),Y.Xb(),Y.Xb()}2&e&&Y.sc("matTooltip",Y.mc(1,1,"strategy.lineNode"))}function _e(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",93),Y.gc("click",(function(){return Y.Jc(n),Y.kc(2).showEdit()})),Y.lc(1,"translate"),Y.Yb(2,"mat-icon",87),Y.Uc(3,"edit"),Y.Xb(),Y.Xb()}2&e&&Y.sc("matTooltip",Y.mc(1,1,"strategy.edit"))}var $e=function(e,t){return{left:e,top:t}};function et(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",79),Y.gc("mousewheel",(function(e){return Y.Jc(n),Y.kc().onWheel(e)})),Y.Sc(1,ze,2,1,"div",80),Y.Sc(2,He,1,0,"mat-divider",81),Y.Yb(3,"div",82),Y.Sc(4,Ke,4,3,"div",83),Y.Sc(5,qe,4,3,"div",84),Y.Sc(6,_e,4,3,"div",85),Y.Yb(7,"div",86),Y.gc("click",(function(){return Y.Jc(n),Y.kc().deleteNode()})),Y.lc(8,"translate"),Y.Yb(9,"mat-icon",87),Y.Uc(10,"delete"),Y.Xb(),Y.Xb(),Y.Xb(),Y.Xb()}if(2&e){var i=Y.kc();Y.sc("@fadeInOut",void 0)("ngStyle",Y.wc(10,$e,i.editControlsPosition.left+"px",i.editControlsPosition.top+"px")),Y.Gb(1),Y.sc("ngIf","EndActuator"!==i.selectElement.name&&i.editControls.length>0),Y.Gb(1),Y.sc("ngIf","EndActuator"!==i.selectElement.name&&i.editControls.length>0),Y.Gb(2),Y.sc("ngIf","line"!==i.selectElement.type),Y.Gb(1),Y.sc("ngIf","line"!==i.selectElement.type&&"EndActuator"!==i.selectElement.name),Y.Gb(1),Y.sc("ngIf","linkLine"!==i.selectElement.name&&"trigger"!==i.selectElement.type&&"EndActuator"!==i.selectElement.name&&"DiversionFilter"!==i.selectElement.name),Y.Gb(1),Y.sc("matTooltip",Y.mc(8,8,"strategy.delete"))}}function tt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",94),Y.Yb(1,"mat-form-field",95),Y.Yb(2,"mat-label",96),Y.Uc(3),Y.lc(4,"translate"),Y.Xb(),Y.Yb(5,"input",97,98),Y.gc("input",(function(e){return Y.Jc(n),Y.kc().setText(e)})),Y.Xb(),Y.Xb(),Y.Xb()}if(2&e){var i=Y.kc();Y.sc("@fadeInOut",void 0)("ngStyle",Y.wc(5,$e,i.inputPosition.left+"px",i.inputPosition.top+"px")),Y.Gb(3),Y.Vc(Y.mc(4,3,i.label))}}function nt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",101),Y.gc("click",(function(){Y.Jc(n);var e=Y.kc().$implicit;return Y.kc(2).changeTypes(e)})),Y.lc(1,"translate"),Y.jc(),Y.Yb(2,"svg",90),Y.Tb(3,"circle",91),Y.Xb(),Y.Xb()}if(2&e){var i=Y.kc().$implicit;Y.sc("matTooltip",Y.mc(1,2,i.name))("id","change-"+i.type)}}function it(e,t){if(1&e&&(Y.Wb(0),Y.Sc(1,nt,4,4,"div",100),Y.Vb()),2&e){var n=t.$implicit;Y.Gb(1),Y.sc("ngIf","EndActuator"!==n.type||"EndActuator"===n.type)}}function at(e,t){if(1&e&&(Y.Yb(0,"div",99),Y.Yb(1,"div",82),Y.Sc(2,it,2,1,"ng-container",88),Y.Xb(),Y.Xb()),2&e){var n=Y.kc();Y.sc("ngStyle",Y.wc(3,$e,n.changeTypePosition.left+"px",n.changeTypePosition.top+"px"))("@fadeInOut",void 0),Y.Gb(2),Y.sc("ngForOf",n.changedTypes)}}function ct(e,t){if(1&e&&(Y.Yb(0,"span",112),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc(2);Y.Gb(1),Y.Xc("",Y.mc(2,2,"strategy.editInfo.selectedRules"),"\xa0:\xa0",n.selectElement.params.couponRules.length,"")}}function ot(e,t){if(1&e&&(Y.Yb(0,"span",112),Y.Uc(1),Y.lc(2,"translate"),Y.Xb()),2&e){var n=Y.kc(2);Y.Gb(1),Y.Xc("",Y.mc(2,2,"strategy.editInfo.selectedTag"),"\xa0:\xa0",n.selectElement.params.selectedTag.length,"")}}var st=function(e){return{y:"100%",opacity:"0",delay:e,duration:"500ms"}},rt=function(e){return{value:"*",params:e}};function lt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"mat-chip",116),Y.gc("removed",(function(){Y.Jc(n);var e=t.$implicit;return Y.kc(3).removeTag(e)})),Y.Yb(1,"span"),Y.Uc(2),Y.Xb(),Y.Yb(3,"mat-icon",117),Y.Uc(4,"cancel"),Y.Xb(),Y.Xb()}if(2&e){var i=t.$implicit,a=t.index;Y.sc("removable",!0)("selectable",!1)("matTooltip",i.name)("@animate",Y.vc(7,rt,Y.vc(5,st,50*a+"ms"))),Y.Gb(2),Y.Vc(i.name)}}function dt(e,t){if(1&e){var n=Y.Zb();Y.Wb(0),Y.Yb(1,"div",113),Y.Yb(2,"mat-chip-list"),Y.Yb(3,"button",114),Y.gc("click",(function(){Y.Jc(n);var e=Y.kc(2),t=Y.Fc(120);return e.openPassengersTag(t)})),Y.Yb(4,"mat-icon",108),Y.Uc(5,"add "),Y.Xb(),Y.Xb(),Y.Sc(6,lt,5,9,"mat-chip",115),Y.Xb(),Y.Xb(),Y.Vb()}if(2&e){var i=Y.kc(2);Y.Gb(6),Y.sc("ngForOf",i.selectElement.params.selectedTag)}}function gt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",122),Y.Yb(1,"div",12),Y.Yb(2,"span"),Y.Uc(3),Y.lc(4,"translate"),Y.Xb(),Y.Yb(5,"button",123),Y.gc("click",(function(){Y.Jc(n);var e=t.$implicit;return Y.kc(3).removeCoupon(e)})),Y.Yb(6,"mat-icon",124),Y.Uc(7,"cancel"),Y.Xb(),Y.Xb(),Y.Xb(),Y.Yb(8,"span",16),Y.Uc(9),Y.lc(10,"translate"),Y.Xb(),Y.Yb(11,"span",16),Y.Uc(12),Y.Xb(),Y.Yb(13,"span",16),Y.Uc(14),Y.lc(15,"translate"),Y.Xb(),Y.Xb()}if(2&e){var i=t.$implicit;Y.sc("@animate",Y.vc(15,rt,Y.vc(13,st,100*t.index+"ms"))),Y.Gb(3),Y.Xc("",Y.mc(4,7,"strategy.editInfo.couponName"),"\xa0:\xa0\xa0\xa0",i.name,""),Y.Gb(6),Y.Wc("",Y.mc(10,9,"strategy.editInfo.couponCoding"),"\xa0:"),Y.Gb(3),Y.Vc(i.code),Y.Gb(2),Y.Xc("",Y.mc(15,11,"strategy.editInfo.couponSource"),"\xa0:\xa0\xa0\xa0",i.source,"")}}function ut(e,t){if(1&e){var n=Y.Zb();Y.Wb(0),Y.Yb(1,"div",118),Y.Yb(2,"div",119),Y.gc("click",(function(){Y.Jc(n);var e=Y.kc(2),t=Y.Fc(122);return e.openCouponRuleSelect(t)})),Y.Yb(3,"mat-icon"),Y.Uc(4,"add_circle_outline"),Y.Xb(),Y.Yb(5,"span",120),Y.Uc(6),Y.lc(7,"translate"),Y.Xb(),Y.Xb(),Y.Sc(8,gt,16,17,"div",121),Y.Xb(),Y.Vb()}if(2&e){var i=Y.kc(2);Y.Gb(6),Y.Vc(Y.mc(7,2,"strategy.editInfo.addCoupon")),Y.Gb(2),Y.sc("ngForOf",i.selectElement.params.couponRules)}}function ht(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",119),Y.gc("click",(function(){Y.Jc(n);var e=Y.kc(3),t=Y.Fc(124);return e.openMessageSelect(t)})),Y.Yb(1,"mat-icon"),Y.Uc(2,"add_circle_outline"),Y.Xb(),Y.Yb(3,"span",120),Y.Uc(4),Y.lc(5,"translate"),Y.Xb(),Y.Xb()}2&e&&(Y.Gb(4),Y.Vc(Y.mc(5,1,"strategy.editInfo.addMsgTemplate")))}var pt=function(){return{opacity:"0",delay:"100ms",duration:"500ms"}};function mt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",127),Y.gc("click",(function(){Y.Jc(n);var e=Y.kc(3),t=Y.Fc(124);return e.openMessageSelect(t)})),Y.Yb(1,"div",128),Y.Yb(2,"div",12),Y.Yb(3,"span"),Y.Uc(4),Y.lc(5,"translate"),Y.Xb(),Y.Yb(6,"button",123),Y.gc("click",(function(){return Y.Jc(n),Y.kc(3).removeMessage()})),Y.Yb(7,"mat-icon",124),Y.Uc(8,"cancel"),Y.Xb(),Y.Xb(),Y.Xb(),Y.Yb(9,"span"),Y.Uc(10),Y.Xb(),Y.Xb(),Y.Yb(11,"span",16),Y.Uc(12),Y.lc(13,"translate"),Y.Xb(),Y.Yb(14,"span",16),Y.Uc(15),Y.lc(16,"translate"),Y.Xb(),Y.Yb(17,"span",16),Y.Uc(18),Y.Xb(),Y.Xb()}if(2&e){var i=Y.kc(3);Y.sc("@animate",Y.vc(14,rt,Y.uc(13,pt))),Y.Gb(4),Y.Wc("",Y.mc(5,7,"strategy.editInfo.smsTemplateName"),":"),Y.Gb(6),Y.Wc(" \xa0\xa0\xa0",i.selectElement.params.template.messageTemplateName," "),Y.Gb(2),Y.Xc("",Y.mc(13,9,"strategy.editInfo.smsTemplateType"),"\xa0:\xa0\xa0\xa0",i.selectElement.params.template.messageTemplateType,""),Y.Gb(3),Y.Wc("",Y.mc(16,11,"strategy.editInfo.smsSendSupport"),":"),Y.Gb(3),Y.Vc(i.selectElement.params.template.messageSendSupport)}}function ft(e,t){if(1&e&&(Y.Wb(0),Y.Yb(1,"div",118),Y.Sc(2,ht,6,3,"div",125),Y.Sc(3,mt,19,16,"div",126),Y.Xb(),Y.Vb()),2&e){var n=Y.kc(2);Y.Gb(2),Y.sc("ngIf",!n.selectElement.params.template),Y.Gb(1),Y.sc("ngIf",n.selectElement.params.template)}}function bt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",102),Y.gc("mousewheel",(function(e){return Y.Jc(n),Y.kc().onWheel(e)})),Y.Tb(1,"div",103),Y.Yb(2,"div",104),Y.Yb(3,"div",105),Y.Yb(4,"span"),Y.Uc(5),Y.Xb(),Y.Sc(6,ct,3,4,"span",106),Y.Sc(7,ot,3,4,"span",106),Y.Yb(8,"button",107),Y.gc("click",(function(){return Y.Jc(n),Y.kc().closeEdit()})),Y.Yb(9,"mat-icon",108),Y.Uc(10,"close"),Y.Xb(),Y.Xb(),Y.Xb(),Y.Yb(11,"div",109),Y.Sc(12,dt,7,1,"ng-container",110),Y.Sc(13,ut,9,4,"ng-container",110),Y.Sc(14,ft,4,2,"ng-container",110),Y.Xb(),Y.Xb(),Y.Tb(15,"div",111),Y.Xb()}if(2&e){var i=Y.kc();Y.sc("@fadeInOut",void 0)("ngStyle",Y.wc(9,$e,i.editPosition.left+"px",i.editPosition.top+"px")),Y.Gb(5),Y.Vc(i.selectElement.title),Y.Gb(1),Y.sc("ngIf",i.selectElement.params.couponRules&&i.selectElement.params.couponRules.length>0),Y.Gb(1),Y.sc("ngIf",i.selectElement.params.selectedTag&&i.selectElement.params.selectedTag.length>0),Y.Gb(4),Y.tc("ngSwitch",i.selectElement.name),Y.Gb(1),Y.sc("ngSwitchCase","TagFilter"),Y.Gb(1),Y.sc("ngSwitchCase","SendCouponActuator"),Y.Gb(1),Y.sc("ngSwitchCase","MessageActuator")}}function At(e,t){1&e&&(Y.Tb(0,"app-confirm-dialog",129),Y.lc(1,"translate")),2&e&&Y.sc("content",Y.mc(1,1,"strategy.clearCanvas"))}function yt(e,t){1&e&&(Y.Tb(0,"app-confirm-dialog",129),Y.lc(1,"translate")),2&e&&Y.sc("content",Y.mc(1,1,"strategy.canLeave"))}function vt(e,t){if(1&e&&(Y.Yb(0,"tr"),Y.Yb(1,"td"),Y.Uc(2),Y.lc(3,"translate"),Y.Xb(),Y.Yb(4,"td"),Y.Uc(5),Y.lc(6,"translate"),Y.Xb(),Y.Xb()),2&e){var n=t.$implicit;Y.Gb(2),Y.Vc(Y.mc(3,2,n.shortcut)),Y.Gb(3),Y.Vc(Y.mc(6,4,n.keyboard))}}function wt(e,t){if(1&e&&(Y.Yb(0,"table",130),Y.Yb(1,"tr"),Y.Yb(2,"td",131),Y.Uc(3),Y.lc(4,"translate"),Y.Xb(),Y.Xb(),Y.Sc(5,vt,7,6,"tr",88),Y.Xb()),2&e){var n=Y.kc();Y.Gb(3),Y.Wc(" ",Y.mc(4,2,"strategy.tips.title")," "),Y.Gb(2),Y.sc("ngForOf",n.shortcutKeys)}}function kt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"app-tag",132),Y.gc("dataSelect",(function(e){return Y.Jc(n),Y.kc().onTagSelect(e)})),Y.Xb()}if(2&e){var i=Y.kc();Y.sc("overPanel",!0)("functionIndex",0)("checkbox",!0)("selectedRows",i.selectedTags)}}function Et(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"app-coupon",132),Y.gc("dataSelect",(function(e){return Y.Jc(n),Y.kc().onCouponSelect(e)})),Y.Xb()}if(2&e){var i=Y.kc();Y.sc("overPanel",!0)("functionIndex",1)("checkbox",!0)("selectedRows",i.selectedCouponRules)}}function Gt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"app-message",133),Y.gc("dataSelect",(function(e){return Y.Jc(n),Y.kc().onMessageSelect(e)})),Y.Xb()}if(2&e){var i=Y.kc();Y.sc("overPanel",!0)("functionIndex",2)("singleSelect",!0)("selectedRow",i.selectedMsgTemplate)}}function Tt(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"app-activity",133),Y.gc("dataSelect",(function(e){return Y.Jc(n),Y.kc().onActivitySelect(e)})),Y.Xb()}if(2&e){var i=Y.kc();Y.sc("overPanel",!0)("functionIndex",3)("singleSelect",!0)("selectedRow",i.selectedActivity)}}var St,Mt,xt,It=function(){return{x:"-100%",opacity:"0",delay:"300ms",duration:"300ms"}},Nt=function(){return{y:"-100%",opacity:"0",delay:"300ms",duration:"300ms"}},Yt=function(){return{y:"-100%",opacity:"0",delay:"400ms",duration:"300ms"}},Ct=function(){return{right:"24px"}},Lt=function(e){return{"canvas-right":e}},Ut=function(){return{scale:"0.1",delay:"300ms",duration:"500ms"}},Rt=function(e){return{transform:e}},Zt=((St=function(){function t(n,i,a,c,o,s,r,l,d,g,u,h,p,m){e(this,t),this.fileDownload=n,this.dialog=i,this.http=a,this.notify=c,this.layout=o,this.router=s,this.activatedRoute=r,this.loading=l,this.translate=d,this.snackBar=g,this.sidebarService=u,this.passengerTagService=h,this.couponService=p,this.strategyService=m,this.unsubscribeAll=new y.a,this.db=[],this.process=new Dt,this.triggers=[],this.controls=[],this.actuators=[],this.operations=[],this.offset={x:0,y:0},this.existTrigger=!1,this.nodes=[],this.isDAG=!1,this.edges=[],this.svgScale=1,this.canvasListener=!1,this.singleTrigger=!1,this.position=null,this.positionKey="",this.drawFlag=!1,this.drawLine=null,this.targetNode=new jt,this.sourceNode=new jt,this.editControlsPosition={left:0,top:0},this.editPosition={left:0,top:0},this.changeTypePosition={left:0,top:0},this.label="",this.inputPosition={left:0,top:0},this.showEditControls=!1,this.showEditPanel=!1,this.showInput=!1,this.showChangeType=!1,this.editControls=[],this.changedTypes=[],this.cachedTypes=[],this.selectedCouponRules=[],this.selectedMsgTemplate={},this.selectedTags=[],this.noShortcut=!1,this.selectedActivity=null,this.currentActivity=null,this.shortcutKeys=[],this.propertyOpenFold=!1,this.isFullScreen=!1,this.finished=!1,this.processId="",this.isReload=!1,this.isCopy=!1,this.detailId="",this.strategy=(new A.d).group({id:new A.e(""),name:new A.e("",A.u.required),enabled:new A.e(!1),strategyDesc:new A.e(""),beginDate:new A.e("",A.u.required),endDate:new A.e("",A.u.required)}),this.detailId=this.activatedRoute.snapshot.paramMap.get("id"),this.detailId?(this.isReload=!0,this.config={enableTime:!0,time_24hr:!0,enableSeconds:!0}):this.config={enableTime:!0,time_24hr:!0,minDate:new Date(new Date((new Date).toLocaleDateString()).getTime()),enableSeconds:!0}}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.initControlPanel(),this.initShortcutKeys(),this.notify.foldChange.subscribe((function(t){setTimeout((function(){e.changePanelPosition()}),100)})),this.notify.openChange.subscribe((function(t){setTimeout((function(){e.changePanelPosition()}),100)})),this.translate.onLangChange.subscribe((function(t){e.startTime.setDateLocale(t.lang),e.endTime.setDateLocale(t.lang),setTimeout((function(){e.isReload&&e.reloadStrategy()}))})),this.svgCanvas=document.getElementById("canvas"),this.svgSelection=o.c(this.svgCanvas)}},{key:"ngAfterViewInit",value:function(){var e=this;if(localStorage.getItem("selectedLang")){var t=localStorage.getItem("selectedLang");this.startTime.setDateLocale(t),this.endTime.setDateLocale(t)}setTimeout((function(){e.setImagesToCircle(e.triggers),e.setImagesToCircle(e.controls),e.setImagesToCircle(e.actuators),e.detailId&&e.reloadStrategy()}),300)}},{key:"reloadStrategy",value:function(){var e=this;this.clearNodesAndEdges(),this.strategyService.getStrategy(this.detailId).then((function(t){console.log(t),e.loadFromExit(t)}))}},{key:"loadFromExit",value:function(e){var t=JSON.parse(e.json);t.activity&&(this.currentActivity=t.activity),this.strategy.patchValue(e),this.processId=t.id,this.nodes=t.sourceNodes,this.edges=t.sourceEdges,this.svgScale=t.scale,this.recoverNodesAndEdges()}},{key:"recoverNodesAndEdges",value:function(){var e=this;this.nodes.forEach((function(e){e.center.parentNode=e})),this.edges.forEach((function(t){t.sourceNode=e.nodes.find((function(e){return e.id===t.sourceNode.id})),t.targetNode=e.nodes.find((function(e){return e.id===t.targetNode.id}))})),this.drawNodesAndEdges()}},{key:"drawNodesAndEdges",value:function(){var e=this;this.nodes.forEach((function(t){e.drawNodeFromExit(t)})),this.edges.forEach((function(t){e.drawLineFromExit(t)})),this.svgSelection.select("g").attr("transform","scale("+this.svgScale+")"),this.addTransformToCanvas(),this.addListeners(),this.recoverParamsAndDraw()}},{key:"addListeners",value:function(){var e=this;this.nodes.forEach((function(t){e.addDragToG(t),e.addListenerToNode(t)})),this.edges.forEach((function(t){e.addListenerToLine(t)}))}},{key:"drawNodeFromExit",value:function(e){var t=o.c("#"+e.name).html(),n=o.c(this.svgCanvas).select("#nodes").append("g");n.html(t),n.attr("id",e.id),this.gTransform(n,e.x,e.y),e.g=n}},{key:"drawLineFromExit",value:function(e){var t=e.sourceNode.center,n=e.targetNode.center,i=o.b();i.moveTo(t.x,t.y),i.lineTo(n.x,n.y);var a=i.toString(),c=e.id;this.drawLine=o.c(this.svgCanvas).select("#lines").append("g").attr("id",c).style("cursor","pointer");var s=this.getRectAttrs(t,n,e);this.drawLine.append("path").attr("d",a).attr("marker-end","url(#markerArrow)"),this.drawLine.append("path").attr("d",a).style("stroke-width",10).style("opacity",0),"DiversionFilter"===e.sourceNode.name&&(this.drawLine.append("rect").attr("x",s.centerX-30).attr("y",s.centerY-12).attr("width",60).attr("height",22).attr("rx",10).style("fill","white").style("stroke","#00000080"),this.drawLine.append("text").style("font-size","14px").style("font-family","Muli").attr("id",c+"_text").attr("text-anchor","middle").attr("x",s.centerX).attr("y",s.centerY+4)),e.g=this.drawLine}},{key:"recoverParamsAndDraw",value:function(){this.nodes.forEach((function(e){})),this.edges.forEach((function(e){"DiversionFilter"===e.sourceNode.name&&e.params.chance&&o.c("#"+e.id+"_text").text(e.params.chance+"%")})),this.loading.hide()}},{key:"initSms",value:function(){this.http.get(sessionStorage.getItem("baseUrl")+"bridge4sms/api/sms-infos?page=0&size=2000").subscribe((function(e){console.log(e)}))}},{key:"changePanelPosition",value:function(){this.showEditControls&&this.getPanelPosition()}},{key:"openActivity",value:function(e){var t=this;this.selectedActivity=this.currentActivity,this.dialog.open(e,{id:"activity",width:"80%"}).afterClosed().subscribe((function(e){e?t.currentActivity=t.selectedActivity:t.selectedActivity=null}))}},{key:"onActivitySelect",value:function(e){this.selectedActivity=e}},{key:"openPassengersTag",value:function(e){var t=this;this.selectedTags=[],Object.assign(this.selectedTags,this.selectElement.params.selectedTag),this.dialog.open(e,{id:"tagSelect",width:"80%"}).afterClosed().subscribe((function(e){e?(t.selectElement.params.selectedTag=[],Object.assign(t.selectElement.params.selectedTag,t.selectedTags)):t.selectedTags=[]}))}},{key:"setTextToLine",value:function(e){o.c("#"+this.selectElement.id+"_text").text(e)}},{key:"onTagSelect",value:function(e){this.selectedTags=e}},{key:"removeTag",value:function(e){this.selectElement.params.selectedTag=this.selectElement.params.selectedTag.filter((function(t){return t!==e}))}},{key:"openCouponRuleSelect",value:function(e){var t=this;console.log(e),this.selectedCouponRules=[],Object.assign(this.selectedCouponRules,this.selectElement.params.couponRules),this.dialog.open(e,{id:"couponRule",width:"80%"}).afterClosed().subscribe((function(e){e?(t.selectElement.params.couponRules=[],Object.assign(t.selectElement.params.couponRules,t.selectedCouponRules)):t.selectedCouponRules=[]}))}},{key:"onCouponSelect",value:function(e){this.selectedCouponRules=e}},{key:"removeCoupon",value:function(e){this.selectElement.params.couponRules=this.selectElement.params.couponRules.filter((function(t){return t!==e}))}},{key:"openMessageSelect",value:function(e){var t=this;this.selectedMsgTemplate={},Object.assign(this.selectedMsgTemplate,this.selectElement.params.template),this.dialog.open(e,{id:"messageTemplate",width:"80%"}).afterClosed().subscribe((function(e){e&&t.selectedMsgTemplate?(t.selectElement.params.template={},Object.assign(t.selectElement.params.template,t.selectedMsgTemplate)):t.selectedMsgTemplate=null}))}},{key:"onMessageSelect",value:function(e){this.selectedMsgTemplate=e}},{key:"removeMessage",value:function(){this.selectElement.params.template=null}},{key:"initShortcutKeys",value:function(){this.shortcutKeys=[{shortcut:"strategy.tips.edit",keyboard:"strategy.tips.editKey"},{shortcut:"strategy.tips.line",keyboard:"strategy.tips.lineKey"},{shortcut:"strategy.tips.delete",keyboard:"strategy.tips.deleteKey"},{shortcut:"strategy.tips.moveUp",keyboard:"strategy.tips.moveUpKey"},{shortcut:"strategy.tips.moveDown",keyboard:"strategy.tips.moveDownKey"},{shortcut:"strategy.tips.zoomIn",keyboard:"strategy.tips.zoomInKey"},{shortcut:"strategy.tips.zoomOut",keyboard:"strategy.tips.zoomOutKey"},{shortcut:"strategy.tips.drawBegin",keyboard:"strategy.tips.drawBeginKey"},{shortcut:"strategy.tips.append",keyboard:"strategy.tips.appendKey"},{shortcut:"strategy.tips.totalDrag",keyboard:"strategy.tips.totalDragKey"},{shortcut:"strategy.tips.operate",keyboard:"strategy.tips.operateKey"},{shortcut:"strategy.tips.nodeDrag",keyboard:"strategy.tips.nodeDragKey"}]}},{key:"showTips",value:function(e){this.dialog.open(e,{id:"strategyTips"})}},{key:"saveSvg",value:function(){this.toSvg(this.translate.instant("strategy.downloadSvg"))}},{key:"toSvg",value:function(e){var t=this,n=o.c("#canvas").node().outerHTML;(new s).file(e,n).forEach((function(e,n){n.async("blob").then((function(n){t.fileDownload.blobDownload(n,e)}))}))}},{key:"loadFromJson",value:function(e){var t=this;if(e.target.value.lastIndexOf(".json")===e.target.value.length-5){var n=e.target.files[0],i=new FileReader;i.readAsText(n),i.onloadend=function(n){try{var i=JSON.parse(n.target.result),a=JSON.parse(i.json);i.json&&a.sourceNodes&&a.sourceEdges&&a.scale?(t.clearNodesAndEdges(),t.loading.show(),t.loadFromExit(i),e.target.value=""):(t.snackBar.open(t.translate.instant("strategy.message.wrongFile"),"\u2716"),e.target.value="")}catch(c){t.snackBar.open(t.translate.instant("strategy.message.wrongFile"),"\u2716"),console.log(c),e.target.value=""}}}else e.target.value="",this.snackBar.open(this.translate.instant("strategy.message.noJson"),"\u2716")}},{key:"saveJson",value:function(){var e=x(I(this.nodes)),t=x(I(this.edges));this.formatStrategy(e,t);var n={json:JSON.stringify({sourceNodes:e,sourceEdges:t,scale:this.svgScale})},i=new Blob([JSON.stringify(n)],{type:"application/json"});this.fileDownload.blobDownload(i,this.translate.instant("strategy.downloadJson"))}},{key:"formatStrategy",value:function(e,t){e.forEach((function(e){delete e.center.parentNode,delete e.g})),t.forEach((function(e){delete e.g,delete e.sourceNode.center.parentNode,delete e.sourceNode.g,delete e.sourceNode.params,delete e.targetNode.params,delete e.targetNode.g,delete e.targetNode.center.parentNode}))}},{key:"publish",value:function(){}},{key:"onPanelClick",value:function(){this.selectElement&&(this.selectElement.g.classed("node-selected",!1),this.hideEditFlags())}},{key:"save",value:function(){var e=this,t=this.checkStrategy(),n=this.checkNoTrigger(),i=this.checkHundredShunt(),a=this.checkControlNoTarget();if(!this.strategy.valid||t||n||i||a)this.strategy.markAllAsTouched(),t?this.snackBar.open(this.translate.instant("strategy.message.singleNode"),"\u2716"):n?this.snackBar.open(this.translate.instant("strategy.message.noTrigger"),"\u2716"):i?this.snackBar.open(this.translate.instant("strategy.message.hundredShunt"),"\u2716"):a?this.snackBar.open(this.translate.instant("strategy.message.noTarget"),"\u2716"):(this.propertyOpenFold=!1,this.snackBar.open(this.translate.instant("strategy.message.formNotValid"),"\u2716"));else{this.loading.show();var c,o=this.strategy.getRawValue();this.process=o,this.process.beginDate=new Date(this.process.beginDate).toISOString(),this.process.endDate=new Date(this.process.endDate).toISOString(),c={id:this.processId?this.processId:"process_"+b(),name:o.name,node:[],edge:[],sourceNodes:[],sourceEdges:[],scale:this.svgScale},this.nodes.forEach((function(t){var n=new Xt;n.id=t.id,n.type=t.name,n.name=t.title,Object.entries(t.params).length>0?n.params=e.getNodeParams(t):"trigger"!==t.type&&"DiversionFilter"!==t.name&&"EndActuator"!==t.name&&Object.entries(t.params),c.node.push(n)})),this.edges.forEach((function(e){var t=new Jt;t.source=e.sourceNode.id,t.target=e.targetNode.id,Object.entries(e.params).length>0?t.params=e.params:"DiversionFilter"===e.sourceNode.name&&e.sourceNode.title,c.edge.push(t)})),c.sourceEdges=x(I(this.edges)),c.sourceNodes=x(I(this.nodes)),console.log(this.nodes),this.formatStrategy(c.sourceNodes,c.sourceEdges),this.currentActivity&&(c.activity=this.currentActivity),this.process.json=JSON.stringify(c),this.process.createBy="widzz",this.process.createDate=(new Date).toISOString(),console.log(JSON.stringify(this.process)),this.isReload?this.strategyService.updateStrategy(this.process).then((function(){e.finished=!0,e.cancel(!0),e.processId="",e.loading.hide()}),(function(t){e.loading.hide()})):setTimeout((function(){e.strategyService.createStrategy(e.process).then((function(){e.finished=!0,e.loading.hide(),e.processId="",e.cancel(!0)}))}),300)}}},{key:"getNodeParams",value:function(e){var t=x(I(e));switch(t.name){case"TagFilter":return t.params.selectedTag=t.params.selectedTag.map((function(e){return e.name})).join(","),t.params;case"SendCouponActuator":return t.params.couponRules=t.params.couponRules.map((function(e){return e.number})).join(","),t.params}}},{key:"cancel",value:function(e){sessionStorage.setItem("routeReload",JSON.stringify({reload:e})),history.back()}},{key:"checkStrategy",value:function(){var e=this,t=!1;return this.nodes.forEach((function(n){e.edges.find((function(e){return e.id.includes(n.id)}))||(t=!0)})),t}},{key:"checkNoActivity",value:function(){var e=!1;return this.nodes.find((function(e){return"SendCouponActuator"===e.name}))&&!this.currentActivity&&(e=!0),e}},{key:"checkControlNoTarget",value:function(){var e=this,t=!1;return this.nodes.forEach((function(n){"control"!==n.type||"EndActuator"===n.name||e.edges.find((function(e){return e.sourceNode.id===n.id}))||(t=!0)})),t}},{key:"checkNoTrigger",value:function(){var e=!1;return this.nodes.find((function(e){return"trigger"===e.type}))||(e=!0),e}},{key:"checkHundredShunt",value:function(){var e=!1,t={};return this.edges.forEach((function(e){"DiversionFilter"===e.sourceNode.name&&e.params.chance&&(t[e.sourceNode.id]||(t[e.sourceNode.id]=0),t[e.sourceNode.id]+=Number(e.params.chance))})),Object.values(t).forEach((function(t){t<100&&(e=!0)})),e}},{key:"onStartSourceDate",value:function(e,t){t.picker.set("minDate",e)}},{key:"onEndSourceDate",value:function(e,t){t.picker.set("maxDate",e)}},{key:"propertyOpenOrFold",value:function(){this.propertyOpenFold=window.innerWidth>=960&&!this.propertyOpenFold}},{key:"onResize",value:function(){document.fullscreenElement?(this.isFullScreen=!0,this.layout.hideLayout()):(this.isFullScreen=!1,this.layout.showLayout())}},{key:"onKeyPress",value:function(e){if("F11"===e.code)e.preventDefault(),e.stopPropagation(),this.setFullScreen();else if(this.selectElement&&this.showEditControls&&!this.noShortcut)switch(e.code){case"KeyE":"trigger"!==this.selectElement.type&&"DiversionFilter"!==this.selectElement.name&&"EndActuator"!==this.selectElement.name&&"linkLine"!==this.selectElement.name&&this.showEdit();break;case"Space":"EndActuator"!==this.selectElement.name&&this.lineNode();break;case"Delete":case"Backspace":this.deleteNode()}}},{key:"setFullScreen",value:function(){document.fullscreenElement?document.exitFullscreen().then((function(){})):document.documentElement.requestFullscreen().then((function(){}))}},{key:"clearAll",value:function(){var e=this;this.noShortcut=!0,this.dialog.open(this.clearCanvas,{id:"clearCanvas"}).afterClosed().subscribe((function(t){t&&(e.clearNodesAndEdges(),e.strategy.markAsUntouched()),e.noShortcut=!1}))}},{key:"clearNodesAndEdges",value:function(){this.nodes.length>0&&(this.nodes.forEach((function(e){e.g.remove()})),this.edges.forEach((function(e){e.g.remove()})),this.hideEditFlags(),this.errorMsg="",this.nodes=[],this.edges=[])}},{key:"setImagesToCircle",value:function(e,t,n){var i=o.c("#patterns"),a=n?2*n:40;e.forEach((function(e){"line"===t?(i.select("#l-"+e.type).node()||i.append("pattern").attr("id","l-"+e.type).attr("patternUnits","objectBoundingBox").attr("height",1).attr("width",1).append("image").attr("height",a).attr("width",a).attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("xlink:href",e.imgSrc),o.c("#line-"+e.type+" circle").attr("fill","url(#l-"+e.type+")")):"change"===t?(i.select("#c-"+e.type).node()||i.append("pattern").attr("id","c-"+e.type).attr("patternUnits","objectBoundingBox").attr("height",1).attr("width",1).append("image").attr("height",a).attr("width",a).attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("xlink:href",e.imgSrc),o.c("#change-"+e.type+" circle").attr("fill","url(#c-"+e.type+")")):(i.append("pattern").attr("id","p-"+e.type).attr("patternUnits","objectBoundingBox").attr("height",1).attr("width",1).append("image").attr("height",a).attr("width",a).attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("xlink:href",e.imgSrc),o.c("#"+e.type+" .center").attr("fill","url(#p-"+e.type+")"))}))}},{key:"initControlPanel",value:function(){this.triggers=[{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkRCQTQ0REFCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkRCQTQ0REJCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2REJBNDREOEJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2REJBNDREOUJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pmqnw2sAAAH9SURBVHja7JfPLwNBFMdnqsJBxI+mQiQODi449uDiJtyQaBwcBA1/BFd/BKIOEkSiThIXB4mbAyc/gsRBI4ukB1yqfb67M9ttt3uo7RqVzKRv38yb7e5n3o+ZlhMRq+UWYjXeNKAG1IAaUAMG2KLrr7PRjbeZIJ/J/R51gBlknE8yoiZogm6AeQL9ZvS30f9En0O/4x2pl0TkUhkgvDQEiDPnKVxooiSeNopRZ5HNvmvYSEROf/qusE/PpyC3gNhnzgq/MP4A1qOVOkTF6ROHHEAiagCJoriuGQvtKxWmg6mW1RWJCF+bB0gcMl22HsZaCyH/qyoG2Dgg9iA7yNGpkvVYH3/Nb4iZh5ceUHEZMv3L+X0l3/nNIvGIOjcAsWvSQT+74H27MJAQI6QjKOY0ukvQi9BPCPlYUYgVnyQi4cMy93oBdWznGZfz8NoR5voKkVJaJGRlmh3GO7z6Ru5zNvwhIn2F/rW8J63eg0R1cpTEuB9yTk4xXEAPQDYLHlRaJMKD5mbNcHzNyVDHgJ3DDKGaY7DnYJ6XC+pQu80ID2Zd1hbY04DLW/3SllUbYq9wCWhzhqos3IBy0F2VwnMhFEcoqE262o26ywXdg2u3HNWX3au4SLZwPXFZV2FvBGje+gFbepKYW1BG6S9q/adJA2pADagBNeD/APwWYACUpbhXEx+hmgAAAABJRU5ErkJggg==",name:"strategy.securityCheck",type:"securityCheck",belongType:"strategy.trigger"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkRCQTQ0RDZCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkRCQTQ0RDdCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2REJBNDRENEJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2REJBNDRENUJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpXMx1MAAAIsSURBVHja7Fc9SwNBEN3NhwkIQoymULQS/0BKQSxtghZa2VgoigTsRBEbCxEbESyEBLQQ/0IKG/0DImqlYGEjBAULSSRf49u7vWTvLs3FrKTYJZOZnVnYl9mZtxtORKyXR4j1+DAADUAD0AA0AHt8RIIsTuU+GOO85RDXpJj7r8tNSBaxZ8QWYJfFuuJKUi/AJihnOOBsPQrPBmRHeKww0QRUAfEZ1uGdHwygmi135hKQdcg8/A+IvCPWkLEY7Cj8Vf0A1dp1Z6QOOYLsOX7xrRRD7H8ySLSMTOzCinsyKQDW1Kxy9fgZ64NUUMOHxdWhvM4MnrvqsH2D+GtWroOVgyevk2aqDjBSN1fxOHH1RzRLmNd182DJAgXBtqdW1xLdufpI1f6mCutukrjUc9jwFXoKm6ZhX0IveTL6iPm2xYGgUBmrBQXIg/wnSeU/xeIXbDaJzRahT+AYwdH1wS4hFpaZ+oE9DDnAXHR8tlOiDgUmaaIvCaIAz43s1grshqdpviGDmCfZH0YoIFELKklj0wTZAN6kfw3fUQWcKIVbyAXkDJJBLIMTmNVagyiHEjI2APMeWtTXE3z7gqC5//qbRuyau69D5ubvLgPk4mPz2TiK98pLMc25BMO9DwrOy7qPuJ+cW6LFbW5Kadd0jk/cyZqbpMbto/a/bFSKsbPszy7nEd08mIEcY6uxtserkLLveInwmGRbWnnQPPkNQAPQADQADUADsOvjV4ABALfv8DohSjmhAAAAAElFTkSuQmCC",name:"strategy.payment",type:"payment",belongType:"strategy.trigger"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkRCQTQ0RDJCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkRCQTQ0RDNCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2Q0NCN0YyN0JBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2Q0NCN0YyOEJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgsHEr0AAAIpSURBVHja7Ja/axRBFMfnqST4AwPH3YmNIFYnYmUjqIUYO5s0epWVlVUKEWwsLWzFRsE0sRIE/wDF0j4gFgmkCoSLHiJCgufL5+3e7s3OKdxdbuTAGXjMm523+z7znV8rqupmuRxyM14SYAJMgAkwASbAg5UjowY2XnScmCNy0aku4V3FzmCfsPfYCvYbq3O73yb2Cv4l/A0R+cg7q9v36pvjAsqoPwtNAIlsk/g1kM4V7/V9WmuALBuIhZd9VvLYHrYE5LtYU3weWyyTVpObuheormVwft9AgMPYnebLnVYcQJGbpD1aNDPlC5C87PJwh/pH8J7fMsgbcQBVuyTb8xTz1XFajc3B/KWQlz2sG2WTVJToA5iKUnZLOKAMWsJvjPmDPI6CQ6ASQgfrTrx4/SfnYJE8UEv/BuIpJhOoN/lB7avlJ/emvDKIwVE0NLjpAtq6C5TTYLOUMQYUDiSMjTDFKhVeGayzXBl13saQwfM/bvbp7mI750QaHuw67Z92teGfxp/HP8kYTvSRtjCuHz1Gfa64kLLvxABk6HXuxQ+4b7BX5QbI6wXAHqLYLjFP6H+KffOPIcpdohtiA4oByIevU61hX4Bqm1rZzaBqh2+H/kfOVoCILb5b1KeAnaPu0f5OzFcGcBb/Mv7zGFP8mGQtEtQyXlV/qh6gzn2xa071OO0a9TPif/VVnqeeQ9HPxLyN8jeTflgTYAJMgAkwASbA/xNwX4ABAAaR2rNp23KcAAAAAElFTkSuQmCC",name:"strategy.browse",type:"browse",belongType:"strategy.trigger"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkNDQjdGMjVCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkNDQjdGMjZCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2Q0NCN0YyM0JBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2Q0NCN0YyNEJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ph4JgZsAAALVSURBVHja7JjPb01REMfPPFVF80JbbfxMGxqRejYItSASgoiliMTSjoX0T5ASscYCGytJk1qKNH4sxKIihCChki60lVKkjwSvanzmnnP7Xl5XT3KSF7k3mfudM3N753tm5pxzX0VVXT1fOVfnV0YwI5gRzAhmBOv8aqjl4fbrn53zR2OzE/mNvhf9Mvo28BfjnHnFuT/h3c/wncE+BC78eLL1W9wMqnZzf4yMc4ZfsKDoXdhXgY+QMciNQXIYfQ3+LovB+Jz52q9NPWGSG+MRFBlAtqPlRaQNLBJ81lnGVNeaHX8ekuvUpqM6w73IuAXM498KDsTswS0VXz8TBGsi+AL0n8ikT3Lin8T+Q3yGF2OZUD9Bu2+ORpDg0wl63QI9QE4z/kLwDiMgnohl9ytyCrmLrSD+BXYvRiNIRlT8IjD9EHAe5Tn6oLMyhixBfhnaLZQXYD+2I3OT9POLs4qd9ZsvU5qNPrBv3kQ8UVvhD+eeDX8nqrPxCFqji9xEuw+WwFKyMNKsqH4P20xzIGUVsrZoZNwI7sF2NGYGFyGDiaRZqfrJIGmGy1mudE5iOxFzm7GgrSHwFXAU28FQvhXgS2yv0TvsGZ7aj22U8dXwhjZXOYEoR52dIP46hnRCpDcQtr2uB9yUEPHZ3IGtE/V4mNyMq/FHWkPNBFWXhD7bCfaAt8P4DSQO4Ldl/Co8exHfe4g+DS2xNCpB24RFQpepjoAjVX03VNEKhiVW7Y1QbpuERi1xeHUpZOGSna8E3JeMVduNNON34MrqRZJOotbf4bl/KHHag4eR1UghyYrIcvQN+Nejt8xbXHP7dMTPrVC69JOpOxz+w8FnPVhIEm09WLmhp1kT+RSXoOoU97MEmkb/EEq8G2zy1dO3oc+s7LmqiRnjfvFndLRVvItc3KPx76S1kvICKC+W6k28jOPce2sqWvbPo4xgRjAjmBHMCP7fBP8KMAB1OC0krJsIWQAAAABJRU5ErkJggg==",name:"strategy.calendar",type:"calendar",belongType:"strategy.trigger"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkNDQjdGMjFCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkNDQjdGMjJCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2Q0NCN0YxRkJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2Q0NCN0YyMEJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtRNbSoAAAHLSURBVHja7Jc7SwNBEMd3REsbPVPEQnxj8AuI+QKC2PoFTCF2CkawFkQbiwSFs/ED+EDwUaQLAUFBRFC0EGws4imikBQK63/udvHiA1Fx74odmJ3d27vN72Z25jYkpRRxljoRc7GAFtACWkALGHOp/+kDLa63S0KkBNFieaw5HzsPAq5NsEqZS7gexS/ERHNQPRqN4x7cE3wCYkiiqf8GpN8ctxKrd0WYND8LzEH0b6AdAG6H7YT2QfuhrdAR7NWCsSRRsg0vpikIeckH1WGvfeF76LPRLFayCaIFDQS0HfRO0T/D9XPYy3LGeYwsxH6YXe8Cpsffi1IOAOggNNeAVbsx04v5FOY5809wT96UBwUANgAwo4br2JfHCiQJbaKP9x/BmAMEwKHynvChpEyKT/ah3p+YmTT9qSvg16uhmhiA6RL09iJ87QqZXDQKqJJgSxVvHcZaD2pQoiXTWaxlFiGsEK/DYQzAuHEwHoZ9gF0D8LLxLP6mkM/DZLH20G3G2Y+iDr4vOV3q68HSyHDQF3j2OrI6GIKbgMl9cbDgdhwJshLJgVUdt7IKpoqWtYJXfhKBcpmZjtSD9j+JBbSAFtACWkAL+Cd5FWAAQH2hO3Idqm8AAAAASUVORK5CYII=",name:"strategy.offlineCheckIn",type:"offlineCheckIn",belongType:"strategy.trigger"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkMyNjcwRjBCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkNDQjdGMUVCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2QzI2NzBFRUJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2QzI2NzBFRkJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PijTIWwAAAHRSURBVHja7Jg9SMNQEMffiZ11KA6Kk4ODq4M4OPhFwUV0EAtuikMEBTdBSsWxHQTjYCYVRVxsnQXRVdCpqwjiB6IOXUQonP+X5DVpBIcqLxnewetd3ntJfty9uxwlZhZJlhaRcDGABtAAGkADmHBpbeamfD5ft+2upSHBPC+IBqHT0FVMX8Pet57sstqXy+X0e9DutApQlxhzAOrBV70NuhtjCnYJ8IexhdiFI1oVstkgcufI1/LatZmz2Ff6CyA10810OG/9bhh9GPkM+v2WmdeF9Ik+DxKtNVx6ahNjGGvL0DXXq1THXteaJJAB4YXQG0JsICFUFlwgrB+YP+AAvlfvGWRuj3h0L7LjKORZuV7TnSRVdf58mYisjzSsM6e0hhihu0V2ZUJTRZSUT4Bcwe4DmBMKvwR90AqIElJE5mbIg5WhTAHGEepalR4FyFzQGmLrcfsc6jQU4qAWBudUWRUk0I72Qg0vTgPihcIwP4FRIGksli8JvChfPhpKBBFJDPk7iX3PsXUzeHkFIIuREqSsLYT2LPZ2CxC7UMcKzse7wfxKYvpBwMxC3ftJ8gU1nsSGVdbFO4wsgN//66Fk/psxgAbQABpAA2gAY5VvAQYAhGCj4H45++gAAAAASUVORK5CYII=",name:"strategy.position",type:"position",belongType:"strategy.trigger"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkMyNjcwRUNCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkMyNjcwRURCQTVDMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2QzI2NzBFQUJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2QzI2NzBFQkJBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpP6UHIAAAK3SURBVHja7Jc9aFRBEIBnk0NP8YJ/GImNYqNgZSFYBTuxUa4RLAQlqZJCsFARIkbEpI1eo502YhOEswmWgqgoWKhotEpyByEinH/Jqbd+49t92fMH7iQLV7yFzc7s7Hvz3czu7Iux1konty7p8JYBZoAZYAaYAXZ4y7W6cMuNhQkxZiviLa7HshEpIFvm6mLtUrrQGNHrE/sa5BwKonykH0E/xjg3P7Dp1IoDcmMX8HQaccYY9Sm1XyB6lxvTD8gB5jYwLmCdQn4UPCvDldJkadvwU+wjUSJIG+PlVY2QJFBikmiNMXPGf3KYZBhFH8F4ySzP6XNVq++JAYiT10H6ktGYXQqXZDax+TQT2VGk28jTfn6oUvrG8FbkQpQI9kCwCFDdA6HvdZFJIyoBJE3t025LSKlvSIUCeLUYgA23nSSFEvkSwKSgHpK/n/4C3YhZZhoexrl8GcCmkNanWeRFCq0pnrtmpc0P5HYiqK/Os7d6NJcmcbRI/4He7fdmcFDqztanT3KCFe5DUxZWOoImWa+1Led+nG76h5IcmN+XP6B/d+uSbkxXtELtAvNZi64NS4eWDWPKTftMZWvHkat+Een1B2VdzD3YLc1w2u4Bcy68RWhnkaccaLrQneJoEQwBmiGNeYLhKLY8qV5Cfh4cJGmb6j8j2PD1zzlcj3KIfhWg++gD2DYin2DuFfpF9H7Wrk1PcaVk3b5sPSat/l/Mx4IXd+JQ07oDedW/Ih3UxRrjDFoRwDea5vnBzTZGBE86x+9w+LgJzgMFJzn94VqWuCYVzqV9MNYeLNJ76Xfox3FUJoXjAGz/o/gu18RZoM8z3qQO7gb6MPJ++vUYgJdxvIdxtdMV9C4AReYPIu9j7EWfZXwmySfXJPJXV3ry6O+RrkTZg9knfwaYAWaAGWAGmAFGaT8FGACG7CHJLGeGBAAAAABJRU5ErkJggg==",name:"strategy.faceDetect",type:"faceDetect",belongType:"strategy.trigger"}],this.controls=[{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAYFBMVEUAAADxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQhZuNurAAAAH3RSTlMA4fDAILD7BJnz2MsB7WFSRDYsELyin5KQiXdpRyofzFjoWwAAAJJJREFUOMvt0UkOgzAQRNHqONjGJoyZJ+5/y6BGZADbZIEEC976q9VSYbV0h82AVa7Q1gPkDB9xv5MFnLJ+eIPH5bc7wkftvzur4FXRp9s9EVDId5gjKO26K0botouSsVAZfrDSEdP+UvAkoFo0JP0RbhsxzXKRTRHqLpSnswyFSWY4FCVQCkKASo3GvZ0mx2rxXobvFxjXwmRyAAAAAElFTkSuQmCC",name:"strategy.TagFilter",type:"TagFilter",belongType:"strategy.control"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAUVBMVEUAAADxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQjxkQgva102AAAAGnRSTlMAwLC83Qn0qe3Q5tXMx51jXT4tgXx0bFOKFUO7w50AAACeSURBVDjL7ZHLDsIgEEVnKNjSBxTsQ+//f6hQF8SFTIwrTc8KkpObmTt08mtcu85Ljlka5gvQSN6AJyyIK9A411USTQjhTtRiSp95HPd3ogPQEykoqsNIfCAOaI96el8VeQB6rtfDeIWropoArZQSE4nGY0Zv7f711jcAWhQzMUaTL2PTe9F6FvQNsGWZCmYq9Qjm1pZEkTXPePJPPAC6cAxXKai93AAAAABJRU5ErkJggg==",name:"strategy.DiversionFilter",type:"DiversionFilter",belongType:"strategy.control"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REI3REZBN0FCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REMyQTk4OThCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpEQjdERkE3OEJBNUUxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpEQjdERkE3OUJBNUUxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ps7sW7YAAAbmSURBVHja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",name:"strategy.EndActuator",type:"EndActuator",belongType:"strategy.control"}],this.actuators=[{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REI3REZBNzJCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REI3REZBNzNCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpEQjdERkE3MEJBNUUxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpEQjdERkE3MUJBNUUxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoSuMHcAAARZSURBVHja7JxrqBRVAMfn+shKPxRJYYaCaIraw6RvgZJKD4JUTPGi4KOS+lJX62Lph8hLEkjdT4oQBT0sQRBBBfPxwb5EVJoPfFSgUaihiFw1Qq/b/7AH9tzTPu6c3dk9Dr8f/Jmd8ezM7P7uec3M2lYoFBLILwP4ChAMCAYEA4IBwYBgQDCCAcGAYEAwIBgQDAhGMCAYEAwIBgQDggHBgGAEA4IBwYBgQDAgGBCMYEAwIBgQDAgGBAOCEQwIBgRDhAyK5URmbH66XYuXlfudzW1llteV6ftXHOix7zOLLmVBlfelfV1vWbPcoXNcgeCipBe1+KqO8x6vjI2s8ryqtFxwLE10d4qyV5Vb3rbLEbaOm+iDSzyUs65vk5rn1xFc4t863x/T/6j6dSxyYxLcm6Pa+z7TpHyzAMGt5WY/y10L3P97mhVsVAYgOKwPbfPmnkkKYROVSf0cE4xRXgj8PK8p2xDcPP5QRisnlNPKuzXKm3n538ouZWrgIHAOgpvLJef1euW7KnPyPc762cDj/YPgEkMz3v8oZa+37bmkeNnT5ZjS4W37RRkScMyFCC5xownHmKm86fXJs70yz3rrW5SRKY9zUXlUc+EdCC7xuLJcOZfxcT5WJjvrplZvtq8XK385/7Y4sBaultyjsfRLUdxs0BdiBj6nNbXYbpvJBzMchX/r7d80ySeVL51tptZ+HvhxfmYeXFm0uWmwLOPDjFAOKgOdwZB7s2O4HW2HMgvB1SWbEeyFDHb9p20djisTlGkVyr1k++fDypGA8UGXWqL5CK7OsQbvr8f2vY/YpXmo4KcKZb+wtXyK8pjyScpjDVa2SnIngitT6/Zh2itZphm+4m27UqHsVW89tDX5EMFl0F/+uKT4hEYsg8lbyW3MoAjP6dMG117DPcpHynlncGX+uL833b5T7nnlCTsqL9hjtQd+js8Q3LfmmhsBG5SnMmqpOsps3+cJ/sD2u0mdNX6VBovdCC7J/UGLJzM8RK+9yHHOaQFMDf3RK/eWHYi5rcUSb1stOmORG1MNrldurQsdZkD1dj/2s8/G5c6UgvcyD/4/WT8V2dvE7+gZBKevgfVyt3Jf4HtHpSy/Tl3OQgQ3F3M70lzBOpUUb/j/qvymvOOVM7+Q+N3JGeWVlMcytxa3SHIXfXA4IVOlB2xcxnjrD5fZFsoaZS01uLVc9NYv5O0D8thsXwY3cF8dNNGtZ6lyb1J8lNb0nfMasE8zJVukufBOBLd+FG765Eb/AnBVLHJv1ya6LfLzO0Qf3Px5cDPhpytluCNHtbhTc+A3ENyXm0m+6JbkuQgu8U2KsneVqcHDaKrjHkWvTIpPcfTnrpJ5/MZ/ysJcsOiJTPDuKEakhUKexjeQh2kSIBgQjGBAMCAYEAwIBgQDghEMCAYEA4IBwYBgQDCC+QoQDAgGBAOCAcGAYEAwggHBgGBAMCAYEAwIRjAgGBAMCAYEA4IBwYDg/POfAAMAs/vHOu7OeqoAAAAASUVORK5CYII=",name:"strategy.SendCouponActuator",type:"SendCouponActuator",belongType:"strategy.actuator"},{imgSrc:"data:image/png;base64,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",name:"strategy.MessageActuator",type:"MessageActuator",belongType:"strategy.actuator"}],this.operations=[{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REE0Q0Q5NUZCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REE0Q0Q5NjBCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpEQTRDRDk1REJBNUUxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpEQTRDRDk1RUJBNUUxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkA8UUsAAAXgSURBVHja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",name:"strategy.handTool",type:"handTool",belongType:"strategy.operation"},{imgSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REE0Q0Q5NUJCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REE0Q0Q5NUNCQTVFMTFFOUJFMTBCQzFGREU1NTE1NzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2REJBNDREQ0JBNUMxMUU5QkUxMEJDMUZERTU1MTU3MyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpEQTRDRDk1QUJBNUUxMUU5QkUxMEJDMUZERTU1MTU3MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ph9sCZ8AAAYESURBVHja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",name:"strategy.connectTool",type:"connectTool",belongType:"strategy.operation"}]}},{key:"onDragStart",value:function(e){var t=e.target.getBoundingClientRect();this.offset.x=e.pageX-t.left,this.offset.y=e.pageY-t.top,e.dataTransfer.setData("text/plain",e.target.id),this.dragControl=e.target,e.dataTransfer.effectAllowed="move"}},{key:"onTouchStart",value:function(e){var t;e.target.parentNode?(this.dragControl=e.target.parentNode.parentNode,t=e.target.parentNode):(t=e.target,this.dragControl=e.target.parentNode);var n=t.getBoundingClientRect(),i=e.touches[0];if(this.offset.x=i.pageX-n.left,this.offset.y=i.pageY-n.top,!o.c("#dragSvg").node()){var a=o.c(t.cloneNode(!0)).style("z-index","1").style("position","absolute").style("left",n.left).style("top",n.top).attr("id","dragSvg");document.body.appendChild(a.node())}}},{key:"onTouchMove",value:function(e){if(o.c("#dragSvg").node()){var t=e.touches[0];o.c("#dragSvg").style("left",t.pageX-this.offset.x).style("top",t.pageY-this.offset.y)}}},{key:"onTouchEnd",value:function(e){o.c("#dragSvg").node()&&o.c("#dragSvg").remove(),document.getElementById("container-3");var t=e.changedTouches[0];if(e.offsetX=t.pageX-152,e.offsetY=t.pageY-132,"canvas"===document.elementFromPoint(t.pageX,t.pageY).id){var n=this.dragControl.getAttribute("data-type");this.drawNode(e,n)}}},{key:"onDragOver",value:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}},{key:"onControlDrop",value:function(e){if(e.preventDefault(),"canvas"===e.target.id){var t=this.dragControl.getAttribute("data-type");this.drawNode(e,t)}}},{key:"drawNode",value:function(e,t){var n=o.c(this.svgCanvas).select("#nodes").append("g");n.html(this.dragControl.innerHTML);var i=Math.round((e.offsetX-this.offset.x)/this.svgScale),a=Math.round((e.offsetY-this.offset.y)/this.svgScale);this.gTransform(n,i,a);var c=this.addNode(t,n,i,a);if(this.checkTriggerExit(c))return n.remove(),void this.snackBar.open(this.translate.instant("strategy.message.singleTrigger"),"\u2716");this.nodes.push(c),this.addDragToG(c),this.getNodePoints(c),this.addTransformToCanvas(),this.addListenerToNode(c),this.gSelected(c)}},{key:"checkTriggerExit",value:function(e){return this.nodes.map((function(e){return"trigger"===e.type?e.name:null})).includes(e.name)}},{key:"checkNodeCanLinkTo",value:function(){var e=this;return this.isDAG=!0,this.checkDAG(),this.errorMsg=this.sourceNode.id===this.targetNode.id?this.translate.instant("strategy.message.noSelf"):this.edges.find((function(t){return t.sourceNode.id===e.sourceNode.id&&t.targetNode.id===e.targetNode.id}))?this.translate.instant("strategy.message.lineExist"):"trigger"===this.targetNode.type?this.translate.instant("strategy.message.triggerTarget"):this.isDAG?"":this.translate.instant("strategy.message.notDAG"),!!this.errorMsg}},{key:"DFS",value:function(e,t,n,i){e[n[i].id]=1;for(var a=0;a<n.length;a++)if(0!==t[n[i].id][n[a].id]){if(1===e[n[a].id]){this.isDAG=!1;break}-1===e[n[a].id]||this.DFS(e,t,n,a)}e[n[i].id]=-1}},{key:"checkDAG",value:function(){var e={},t={},n=[],i=[];Object.assign(n,this.edges),Object.assign(i,this.nodes);var a=new Ft;a.sourceNode=this.sourceNode,a.targetNode=this.targetNode,n.push(a);for(var c=0;c<i.length;c++){var o=i[c];e[o.id]={};for(var s=0;s<i.length;s++)e[o.id][i[s].id]=0}for(var r=0;r<n.length;r++){var l=n[r];e[l.sourceNode.id][l.targetNode.id]=1}for(var d=0;d<i.length;d++)t[i[d].id]=0;for(var g=0;g<i.length;g++)-1!==t[i[g].id]&&this.DFS(t,e,i,g)}},{key:"showEditControl",value:function(e){this.showEditControls=!0,this.showEditPanel=!1,this.showInput=!1,this.showChangeType=!1,this.selectElement=e,this.getPanelPosition(),this.getEditControls()}},{key:"addListenerToNode",value:function(e){var t=this;e.g.on("click",(function(){t.drawFlag||(e.g.classed("node-selected")||t.gSelected(e),t.showEditControl(e))}));var n=e.g.select(".center");n.on("mouseenter",(function(e){if(t.drawFlag){var i=e.target.parentNode.parentNode.id;t.targetNode=t.nodes.find((function(e){return e.id===i})),t.drawFlag&&!t.checkNodeCanLinkTo()?(n.style("cursor","pointer"),n.style("stroke","#DCFECC")):(n.style("stroke","#f9dee5"),n.style("cursor","not-allowed"))}else n.style("cursor","pointer")})),n.on("mouseleave",(function(i){if(t.drawFlag){t.errorMsg="";var a=i.target.parentNode.parentNode.id;t.targetNode=t.nodes.find((function(e){return e.id===a})),n.style("cursor","pointer"),n.style("stroke",null),e.g.classed("node-selected",!1)}})),n.on("mousedown",(function(e){var i=e.target.parentNode.parentNode.id;t.targetNode=t.nodes.find((function(e){return e.id===i})),t.drawFlag&&!t.checkNodeCanLinkTo()&&(t.drawLine.remove(),t.drawFlag=!1,t.drawNewLinePointToPoint(t.sourceNode.center,t.targetNode.center)),t.errorMsg="",n.style("stroke",null)}))}},{key:"drawNewLinePointToPoint",value:function(e,t){var n=o.b();n.moveTo(e.x,e.y),n.lineTo(t.x,t.y);var i=n.toString(),a=new Ft,c=e.parentNode.id+"_"+t.parentNode.id;this.drawLine=o.c(this.svgCanvas).select("#lines").append("g").attr("id",c).style("cursor","pointer");var s=this.getRectAttrs(e,t,a);this.drawLine.append("path").attr("d",i).attr("marker-end","url(#markerArrow)"),this.drawLine.append("path").attr("d",i).style("stroke-width",10).style("opacity",0),a.g=this.drawLine,a.sourceNode=e.parentNode,a.targetNode=t.parentNode,a.id=c,a.type="line","DiversionFilter"===a.sourceNode.name?(a.name=a.sourceNode.name+"Line",this.drawLine.append("rect").attr("x",s.centerX-30).attr("y",s.centerY-12).attr("width",60).attr("height",22).attr("rx",10).style("fill","white").style("stroke","#00000080"),this.drawLine.append("text").style("font-size","14px").style("font-family","Muli").attr("id",c+"_text").attr("text-anchor","middle").attr("x",s.centerX).attr("y",s.centerY+4)):a.name="linkLine",this.addListenerToLine(a),this.edges.push(a)}},{key:"addListenerToLine",value:function(e){var t=this;e.g.on("click",(function(){event.preventDefault(),t.hideEditFlags(),t.lineSelected(e)}))}},{key:"getRectAttrs",value:function(e,t,n){var i={x:0,y:0,width:0,height:0,centerX:0,centerY:0};return e.x<=t.x?e.y<=t.y?(i.x=e.x,i.y=e.y,i.width=t.x-e.x,i.height=t.y-e.y):(i.x=e.x,i.y=t.y,i.width=t.x-e.x,i.height=e.y-t.y):e.y<=t.y?(i.x=t.x,i.y=e.y,i.width=e.x-t.x,i.height=t.y-e.y):(i.x=t.x,i.y=t.y,i.width=e.x-t.x,i.height=e.y-t.y),i.centerX=i.x+i.width/2,i.centerY=i.y+i.height/2,n.x=i.x,n.y=i.y,i}},{key:"drawExistLine",value:function(e){var t=o.b();t.moveTo(e.sourceNode.center.x,e.sourceNode.center.y),t.lineTo(e.targetNode.center.x,e.targetNode.center.y);var n=t.toString(),i=this.getRectAttrs(e.sourceNode.center,e.targetNode.center,e);e.g.selectAll("path").attr("d",n),e.g.select("rect").attr("x",i.centerX-30).attr("y",i.centerY-12),e.g.select("text").attr("x",i.centerX).attr("y",i.centerY+4)}},{key:"lineSelected",value:function(e){e.g.classed("line-selected",!0),this.selectElement=e,this.getPanelPosition(),this.getEditControls(),this.showEditControls=!0,this.edges.forEach((function(t){t.id!==e.id&&t.g.classed("line-selected",!1)})),this.nodes.forEach((function(e){e.g.classed("node-selected",!1)}))}},{key:"gSelected",value:function(e){"not-allowed"!==e.g.style("cursor")&&(e.g.style("cursor","pointer"),e.g.classed("node-selected",!0),this.nodes.forEach((function(t){t.id!==e.id&&t.g.classed("node-selected",!1)})),this.edges.forEach((function(e){e.g.classed("line-selected",!1)})),this.showEditControl(e))}},{key:"getEditControls",value:function(){var e=this;switch(this.selectElement.type){case"trigger":this.editControls=this.controls;break;case"control":this.editControls=this.actuators.concat(this.controls);break;case"actuator":this.editControls=this.controls.concat(this.actuators);break;case"line":this.editControls=[]}setTimeout((function(){e.setImagesToCircle(e.editControls,"line",12)}))}},{key:"setText",value:function(e){var t=this;if("strategy.oneHundredLabel"===this.label){/(^[0-9]\d*$)/.test(e.target.value)?e.target.value>100&&(e.target.value=100):e.target.value=e.target.value.replace(/\D/g,"");var n=this.edges.filter((function(e){return e.sourceNode.id===t.selectElement.sourceNode.id&&e.id!==t.selectElement.id})),i=0;n.forEach((function(e){e.params.chance&&(i+=Number(e.params.chance))})),""!==e.target.value&&(i+Number(e.target.value)>100&&(e.target.value=100-i),o.c("#"+this.selectElement.id+"_text").text(e.target.value.trim()+"%"),this.selectElement.params.chance=e.target.value)}}},{key:"showEdit",value:function(){var e=this;this.selectElement&&"line"!==this.selectElement.type?(this.editTimestamp&&clearTimeout(this.editTimestamp),this.editTimestamp=setTimeout((function(){e.showEditControls=!1,e.showEditPanel=!0,e.showChangeType=!1,setTimeout((function(){"line"===e.selectElement.type?o.c("#nodeView .center").attr("fill","url(#p-"+e.selectElement.sourceNode.name+")"):o.c("#nodeView .center").attr("fill","url(#p-"+e.selectElement.name+")")}))}),300)):(this.showInput=!0,this.showEditControls=!1,"DiversionFilter"===this.selectElement.sourceNode.name&&(this.label="strategy.oneHundredLabel"),setTimeout((function(){e.textInput.nativeElement.focus()})))}},{key:"closeEdit",value:function(){this.showEditPanel=!1,this.showEditControls=!0,this.getEditControls()}},{key:"hideEditFlags",value:function(){this.showEditControls=!1,this.showInput=!1,this.showChangeType=!1,this.showEditPanel=!1}},{key:"showChangeTypes",value:function(){var e=this;switch(this.showChangeType=!this.showChangeType,this.changedTypes=[],this.cachedTypes=[],this.selectElement.type){case"trigger":this.cachedTypes=this.triggers,this.changedTypes=this.triggers.filter((function(t){return t.type!==e.selectElement.name}));break;case"control":this.cachedTypes=this.controls,this.changedTypes=this.controls.filter((function(t){return t.type!==e.selectElement.name}));break;case"actuator":this.cachedTypes=this.actuators,this.changedTypes=this.actuators.filter((function(t){return t.type!==e.selectElement.name}))}this.showChangeType&&setTimeout((function(){e.setImagesToCircle(e.changedTypes,"change",12)}))}},{key:"changeTypes",value:function(e){var t=this,n=o.c("#"+e.type).html();this.selectElement.g.html(n),this.selectElement.name=e.type,"control"===this.selectElement.type&&this.edges.filter((function(e){return e.sourceNode.id===t.selectElement.id})).forEach((function(e){if("DiversionFilter"===e.sourceNode.name){if(e.name=e.sourceNode.name+"Line",!e.g.select("rect").node()){var n=t.getRectAttrs(e.sourceNode.center,e.targetNode.center,e);e.g.append("rect").attr("x",n.centerX-30).attr("y",n.centerY-12).attr("width",60).attr("height",24).attr("rx",10).style("fill","white").style("stroke","#00000080"),e.g.append("text").style("font-size","14px").style("font-family","Muli").attr("id",e.id+"_text").attr("text-anchor","middle").attr("x",n.centerX).attr("y",n.centerY+4)}}else e.name="linkLine",e.g.select("rect").node()&&(e.g.select("rect").remove(),e.g.select("text").remove());e.params={}})),this.selectElement.translate="strategy."+this.selectElement.name,this.changedTypes=this.cachedTypes.filter((function(t){return t.type!==e.type})),setTimeout((function(){t.addListenerToNode(t.selectElement),t.setImagesToCircle(t.changedTypes,"change",12),t.setImagesToCircle(t.editControls,"line",12)}))}},{key:"getExistNewY",value:function(e,t){var n=this,i=this.nodes.filter((function(t){return t.x===e})),a=!1;return i.forEach((function(n){Math.sqrt(Math.pow(n.x-e,2)+Math.pow(n.y-t,2))<100&&(a=!0)})),this.edges.filter((function(e){return e.id.includes(n.selectElement.id)})).map((function(e){return e.targetNode})).find((function(t){return t.x===e}))||a?this.checkExist(e,t):t}},{key:"checkExist",value:function(e,t){var n=this.nodes.filter((function(t){return t.x===e})).map((function(e){return e.y}));n.sort((function(e,t){return e-t}));var i,a=n[0],c=n[n.length-1];return i=Math.round((a-100)/this.svgScale)>0?Math.round((a-100)/this.svgScale):Math.round((c+100)/this.svgScale),isNaN(i)?t:i}},{key:"getLimit",value:function(e,t,n,i){var a=!1;if(e.forEach((function(e){Math.sqrt(Math.pow(e.x-t,2)+Math.pow(e.y-n,2))<100&&(a=!0)})),!a)return n;i<e.length-1&&(n=e[i+1]),this.getLimit(e,t,n,i+1)}},{key:"appendNode",value:function(e){var t=o.c(this.svgCanvas).select("#nodes").append("g"),n=o.c("#"+e.type).html(),i=o.c("#"+e.type).attr("data-type");t.html(n);var a=Math.round(this.selectElement.x+150/this.svgScale),c=this.selectElement.y;c=this.getExistNewY(a,c),this.gTransform(t,a,c);var s=this.addNode(i,t,a,c);this.nodes.push(s),this.addDragToG(s),this.getNodePoints(s),this.addListenerToNode(s),this.drawNewLinePointToPoint(this.selectElement.center,s.center),this.gSelected(s)}},{key:"deleteNode",value:function(){var e=this;"line"!==this.selectElement.type?(this.nodes=this.nodes.filter((function(t){return t.id!==e.selectElement.id})),this.edges.forEach((function(t){t.id.includes(e.selectElement.id)&&t.g.remove()})),this.edges=this.edges.filter((function(t){return!t.id.includes(e.selectElement.id)}))):this.edges=this.edges.filter((function(t){return t.id!==e.selectElement.id})),this.selectElement.g.remove(),this.selectElement=null,this.hideEditFlags()}},{key:"lineNode",value:function(){this.hideEditFlags(),this.sourceNode=this.selectElement,this.nodes.forEach((function(e){e.g.classed("node-selected",!1)})),this.drawFlag=!0}},{key:"getPanelPosition",value:function(){if(this.selectElement&&"line"!==this.selectElement.type){var e=document.getElementById("control-panel").offsetWidth,t=this.selectElement.g.node().getBBox();this.editControlsPosition={left:Math.round((this.selectElement.x+t.width)*this.svgScale+e+60),top:this.selectElement.y*this.svgScale+80},this.changeTypePosition.left=this.editControlsPosition.left+80,this.changeTypePosition.top=this.editControlsPosition.top,this.editPosition=this.editControlsPosition}else if(this.selectElement&&"line"===this.selectElement.type){var n=document.getElementById("control-panel").offsetWidth,i=this.selectElement.g.node().getBBox();"linkLine"!==this.selectElement.name?(this.editControlsPosition={left:Math.round((this.selectElement.x+i.width/2)*this.svgScale+n+25),top:Math.round(this.selectElement.y+i.height/2)*this.svgScale+20},this.editPosition.left=this.editControlsPosition.left+50,this.editPosition.top=this.editControlsPosition.top+20):(this.editControlsPosition={left:Math.round((this.selectElement.x+i.width/2)*this.svgScale+n+25),top:Math.round(this.selectElement.y+i.height/2)*this.svgScale+50},this.editPosition=this.editControlsPosition),this.inputPosition.left=this.editControlsPosition.left-20,this.inputPosition.top=this.editControlsPosition.top-20}else this.hideEditFlags()}},{key:"gTransform",value:function(e,t,n){e.attr("transform","translate("+t+","+n+")")}},{key:"getRandomId",value:function(e){return e+"_"+Math.round(1e4*Math.random()).toString(10)}},{key:"addNode",value:function(e,t,n,i){var a=new jt,c=t.select("tspan").text(),o=t.select("tspan:nth-child(2)").text();return a.id=this.getRandomId(c),a.type=e,a.name=c,a.title=this.translate.instant(o),a.x=n,a.y=i,t.attr("id",a.id),a.g=t,a}},{key:"getNodePoints",value:function(e){var t=e.x+7.5,n=e.y+7.5,i=e.g.select("circle").node().getBBox(),a=i.height;e.center.x=t+i.width/2,e.center.y=n+a/2,e.center.parentNode=e}},{key:"onWheel",value:function(e){e.ctrlKey&&(e.preventDefault(),this.svgScale+=e.deltaY>0?-.1:.1,this.svgScale=Number(this.svgScale.toFixed(1)),this.svgScale>3?this.svgScale=3:this.svgScale<.5&&(this.svgScale=.5),this.getPanelPosition(),this.svgSelection.select("g").attr("transform","scale("+this.svgScale+")"))}},{key:"addTransformToCanvas",value:function(){var e=this;this.canvasListener||(this.canvasListener=!0,this.svgSelection.call(o.a().on("drag",(function(t){e.svgSelection.style("cursor","grab"),e.nodes.forEach((function(n){n.x+=Math.round(t.dx/e.svgScale),n.y+=Math.round(t.dy/e.svgScale),e.gTransform(n.g,n.x,n.y),e.getNodePoints(n)})),e.edges.forEach((function(t){e.drawExistLine(t)})),e.getPanelPosition()}))),this.svgSelection.call(o.e().on("zoom",(function(t){if(t.sourceEvent&&t.sourceEvent.ctrlKey)e.svgSelection.style("cursor","all-scroll"),e.svgScale+=t.sourceEvent.deltaY>0?-.1:.1,e.svgScale=Number(e.svgScale.toFixed(1)),e.svgScale>3?e.svgScale=3:e.svgScale<.5&&(e.svgScale=.5),e.svgSelection.select("g").attr("transform","scale("+e.svgScale+")");else if(t.sourceEvent){e.svgSelection.style("cursor","s-resize");var n=t.sourceEvent.deltaY;e.nodes.forEach((function(t){t.y+=n>0?-Math.round(50/e.svgScale):Math.round(50/e.svgScale),e.gTransform(t.g,t.x,t.y),e.getNodePoints(t)})),e.edges.forEach((function(t){e.drawExistLine(t)}))}e.getPanelPosition()}))),this.svgSelection.on("mouseenter",(function(t){t.preventDefault(),e.drawDashLine(t)})),this.svgSelection.on("mousemove",(function(t){t.preventDefault(),e.drawDashLine(t)})),this.svgSelection.on("click",(function(t){t.preventDefault(),e.drawFlag&&"path"!==t.target.tagName?(e.svgSelection.style("cursor","default"),o.c(t.target).style("cursor","pointer"),e.drawFlag=!1,e.drawLine.remove(),e.selectElement.g.classed("node-selected",!0),e.showEditControls=!0,setTimeout((function(){e.setImagesToCircle(e.editControls,"line",12)}))):t.target&&"svg"===t.target.tagName&&(e.svgSelection.style("cursor","pointer"),e.nodes.forEach((function(e){e.g.classed("node-selected",!1)})),e.edges.forEach((function(e){e.g.classed("line-selected",!1)})),e.selectElement=null,e.hideEditFlags())})))}},{key:"drawDashLine",value:function(e){if(this.drawFlag){this.svgSelection.style("cursor","not-allowed");var t=o.b();t.moveTo(this.sourceNode.center.x,this.sourceNode.center.y),t.lineTo(e.offsetX>this.sourceNode.center.x?Math.round((e.offsetX-5)/this.svgScale):Math.round((e.offsetX+5)/this.svgScale),Math.round(e.offsetY/this.svgScale));var n=t.toString(),i=this.sourceNode.id+"_"+this.sourceNode.id+"_linkLine";o.c("#"+i).node()?(this.drawLine=o.c("#"+i),this.drawLine.attr("d",n),this.drawLine.style("stroke-dashArray","3,3")):(this.drawLine=o.c(this.svgCanvas).select("#lines").append("path"),this.drawLine.attr("id",i).attr("d",n),this.drawLine.style("stroke-dashArray","3,3"))}else this.svgSelection.style("cursor","default")}},{key:"addDragToG",value:function(e){var t=this;e.g.call(o.a().on("drag",(function(n){e.g.style("cursor","grab"),e.x+=n.dx,e.y+=n.dy,t.gSelected(e),t.gTransform(e.g,e.x,e.y),t.getNodePoints(e),t.edges.forEach((function(e){t.selectElement&&t.selectElement.id===e.id&&(t.selectElement=null,e.g.classed("line-selected",!1)),t.drawExistLine(e)})),t.getPanelPosition()})))}},{key:"ngOnDestroy",value:function(){this.unsubscribeAll.next(),this.unsubscribeAll.complete(),document.fullscreenElement&&document.exitFullscreen()}}]),t}()).\u0275fac=function(e){return new(e||St)(Y.Sb(C.a),Y.Sb(L.c),Y.Sb(U.c),Y.Sb(N.p),Y.Sb(R.a),Y.Sb(Z.h),Y.Sb(Z.a),Y.Sb(N.g),Y.Sb(D.d),Y.Sb(F.b),Y.Sb(N.q),Y.Sb(j),Y.Sb(Q),Y.Sb(B.a))},St.\u0275cmp=Y.Mb({type:St,selectors:[["app-edit-strategy"]],viewQuery:function(e,t){var n;1&e&&(Y.Oc(Ge,!0),Y.Oc(Te,!0),Y.Zc(Se,!0),Y.Zc(Me,!0),Y.Zc(xe,!0)),2&e&&(Y.Ec(n=Y.hc())&&(t.clearCanvas=n.first),Y.Ec(n=Y.hc())&&(t.canLeave=n.first),Y.Ec(n=Y.hc())&&(t.textInput=n.first),Y.Ec(n=Y.hc())&&(t.startTime=n.first),Y.Ec(n=Y.hc())&&(t.endTime=n.first))},hostBindings:function(e,t){1&e&&Y.gc("resize",(function(){return t.onResize()}),!1,Y.Ic)("keydown",(function(e){return t.onKeyPress(e)}),!1,Y.Ic)},decls:127,vars:107,consts:[[1,"page-layout","carded","fullwidth","inner-scroll"],[1,"top-bg","accent"],[1,"center"],["fxLayout","row","fxLayoutAlign","space-between center",1,"header","accent","py-24","px-8"],["class","m-0",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-around center","fxLayoutGap","8px"],["mat-button","","matRipple","","color","accent","fxLayout","row","fxLayoutAlign","space-between center",1,"bg-white","h-32","dark-box-shadow-hover",3,"disableRipple","matRippleRadius","matRippleColor","click"],[1,"iconfont","iconsave","mr-8"],[1,"iconfont","iconreject","mat-icon-12","mr-8"],["fxLayout","row","fxLayoutAlign","start start",1,"content-card"],["id","control-panel","fusePerfectScrollbar","","fxLayout","column","fxLayoutAlign","start center",1,"h-100-p","p-16"],["fxLayout","column","fxLayoutAlign","start start",1,"w-100-p","pb-16"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100-p"],["mat-icon-button","","matTooltipPosition","above",1,"theme-hover",3,"matTooltip","click"],["fxLayout","row wrap","fxLayoutAlign","start center",1,"w-100-p","mt-8","py-8"],["class","node-div","fxLayout","column","data-type","trigger","fxLayoutAlign","space-around center","draggable","true",3,"id","title","touchmove","touchend","touchstart","dragstart",4,"ngFor","ngForOf"],[1,"w-100-p"],["fxLayout","column","fxLayoutAlign","start start",1,"w-100-p","py-16"],["class","node-div","fxLayout","column","fxLayoutAlign","space-around center","data-type","control","draggable","true",3,"id","title","touchmove","touchend","touchstart","dragstart",4,"ngFor","ngForOf"],["class","node-div","fxLayout","column","fxLayoutAlign","space-around center","data-type","actuator","draggable","true",3,"id","title","touchmove","touchend","touchstart","dragstart",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","start start","fxFlex","1 1 auto",1,"h-100-p","p-16"],["fxLayout","row","fxLayoutAlign","space-around center",1,"canvas-left-buttons"],["mat-icon-button","","matTooltipPosition","above",1,"dark-box-shadow-hover","theme-hover",3,"matTooltip","click"],["type","file","hidden","","accept",".json",3,"change"],["jsonFile",""],[4,"ngIf"],["class","error-span ml-8",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-around center",1,"canvas-right-buttons",3,"ngStyle.lt-md","ngClass"],["mat-icon-button","","matTooltipPosition","above","class","dark-box-shadow-hover theme-hover",3,"matTooltip","click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","version","1.1","id","canvas",1,"w-100-p","h-100-p",3,"dragover","drop"],["type","text/css"],["id","patterns"],["id","markerCircle","markerWidth","8","markerHeight","8","refX","5","refY","5"],["cx","5","cy","5","r","3",1,"marker-circle"],["id","markerArrow","markerWidth","8","markerHeight","8","refX","30","refY","4","orient","auto"],["d","M0,0 L0,8 L8,4 L0,0",1,"path-fill-theme"],["id","lines"],["id","nodes"],["id","properties-panel","fxLayout","column","fxLayoutAlign","start start",1,"h-100-p","py-16","px-8","normal-form-fields",3,"ngStyle","click"],["autocomplete","off",3,"formGroup"],["appearance","outline",1,"w-100-p"],["matInput","","formControlName","name"],[3,"timeControl","config","requiredMsg","label","sourceDate"],["startTime",""],["endTime",""],["readonly","","matInput","",1,"select-activity",3,"value","focus"],["labelPosition","before","formControlName","enabled",1,"pl-8","mb-24"],["appearance","outline",1,"w-100-p","text-area"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","10","cdkAutosizeMaxRows","10","formControlName","strategyDesc"],["autosize","cdkTextareaAutosize"],["class","float-panel","fxLayout","column","fxLayoutAlign","space-around center","fxLayoutGap","4px",3,"ngStyle","mousewheel",4,"ngIf"],["class","text-input","fxLayout","column","fxLayoutAlign","space-around center",3,"ngStyle",4,"ngIf"],["class","change-type","fxLayout","column","fxLayoutAlign","space-around center",3,"ngStyle",4,"ngIf"],["class","edit-info","fxLayout","row","fxLayoutAlign","start start",3,"ngStyle","mousewheel",4,"ngIf"],["clearCanvas",""],["canLeave",""],["keyboard",""],["passengersTag",""],["couponTemplate",""],["messageTemplate",""],["activities",""],[1,"m-0"],["fxLayout","column","data-type","trigger","fxLayoutAlign","space-around center","draggable","true",1,"node-div",3,"id","title","touchmove","touchend","touchstart","dragstart"],["width","55","height","80","viewBox","0 0 55 80"],["opacity","0","rx","2","x","5","y","5","height","45","width","45",1,"rect-fill-theme"],["r","20","cx","27.5","cy","27.5","stroke","#aaaaaa","fill","#ffffff"],["r","20","cx","27.5","cy","27.5","stroke","#aaaaaa",1,"center"],["x","27.5","y","70","text-anchor","middle"],["display","none"],["class","path-fill-theme","style","font-size: 10px;text-align: center;",4,"ngIf"],["class","path-fill-theme","style","font-size: 8px;text-align: center;",4,"ngIf"],[1,"path-fill-theme",2,"font-size","10px","text-align","center"],[1,"path-fill-theme",2,"font-size","8px","text-align","center"],["fxLayout","column","fxLayoutAlign","space-around center","data-type","control","draggable","true",1,"node-div",3,"id","title","touchmove","touchend","touchstart","dragstart"],["rx","2","opacity","0","x","5","y","5","height","45","width","45",1,"rect-fill-theme"],["r","20","cx","27.5","cy","27.5","stroke","#aaaaaa","fill","#ffffff",1,"center"],["fxLayout","column","fxLayoutAlign","space-around center","data-type","actuator","draggable","true",1,"node-div",3,"id","title","touchmove","touchend","touchstart","dragstart"],["opacity","0","rx","5","x","5","y","5","height","45","width","45",1,"rect-fill-theme"],[1,"error-span","ml-8"],["fxLayout","column","fxLayoutAlign","space-around center","fxLayoutGap","4px",1,"float-panel",3,"ngStyle","mousewheel"],["fxLayout","row wrap","fxLayoutAlign","start center",4,"ngIf"],["class","w-100-p",4,"ngIf"],["fxLayout","row wrap","fxLayoutAlign","start center"],["fxLayout","row","fxLayoutAlign","space-around center","matTooltipPosition","above",3,"matTooltip","click",4,"ngIf"],["fxLayout","row","matTooltipPosition","above","fxLayoutAlign","space-around center",3,"matTooltip","click",4,"ngIf"],["matTooltipPosition","above","fxLayout","row","fxLayoutAlign","space-around center",3,"matTooltip","click",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-around center","matTooltipPosition","above",3,"matTooltip","click"],[1,"mat-icon-20","theme-hover"],[4,"ngFor","ngForOf"],["matTooltipPosition","above",3,"id","matTooltip","click"],["viewBox","0 0 25 25",2,"cursor","pointer"],["r","12","cx","12.5","cy","12.5","stroke","#aaaaaa","fill","#ffffff"],["fxLayout","row","matTooltipPosition","above","fxLayoutAlign","space-around center",3,"matTooltip","click"],["matTooltipPosition","above","fxLayout","row","fxLayoutAlign","space-around center",3,"matTooltip","click"],["fxLayout","column","fxLayoutAlign","space-around center",1,"text-input",3,"ngStyle"],["color","accent",1,"normal-form-field","w-68"],[1,"font-size-10"],["matInput","",3,"input"],["textInput",""],["fxLayout","column","fxLayoutAlign","space-around center",1,"change-type",3,"ngStyle"],["matTooltipPosition","above",3,"matTooltip","id","click",4,"ngIf"],["matTooltipPosition","above",3,"matTooltip","id","click"],["fxLayout","row","fxLayoutAlign","start start",1,"edit-info",3,"ngStyle","mousewheel"],[1,"triangle-div"],["fxLayout","column","fxLayoutAlign","start center",1,"info-panel"],["fxLayout","row","fxLayoutAlign","space-between center",1,"accent","info-header","h-40","w-100-p","p-8"],["class","ml-8 font-size-12",4,"ngIf"],["mat-icon-button","","fxLayout","row","fxLayoutAlign","space-around center",1,"dark-box-shadow-hover","mat-button-32",3,"click"],[1,"mat-icon-20"],["fxLayout","column","fxLayoutAlign","start center",1,"info-content","p-8","w-100-p",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"expand-panel"],[1,"ml-8","font-size-12"],["fxLayout","column","fxLayoutAlign","start center","fxFlexFill","",1,"p-8","tag-container"],["mat-stroked-button","","color","accent",1,"add-button",3,"click"],["matTooltipPosition","above","class","accent",3,"removable","selectable","matTooltip","removed",4,"ngFor","ngForOf"],["matTooltipPosition","above",1,"accent",3,"removable","selectable","matTooltip","removed"],["matChipRemove",""],["fxLayout","row wrap","fxLayoutAlign","start start","fxFlexFill","",1,"p-8","params-container"],["fxLayout","row","fxLayoutAlign","center center",1,"add-button",3,"click"],[1,"ml-4"],["class","coupon-cell","fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","2px",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","2px",1,"coupon-cell"],["mat-icon-button","","fxLayout","row","fxLayoutAlign","center center",1,"w-24","h-24","remove-button",3,"click"],["color","warn",1,"mat-icon-20"],["class","add-button","fxLayout","row","fxLayoutAlign","center center",3,"click",4,"ngIf"],["class","common-cell cursor-pointer","fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","2px",3,"click",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","2px",1,"common-cell","cursor-pointer",3,"click"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100-p"],[3,"content"],[1,"keyboard","w-100-p"],["colspan","2"],[3,"overPanel","functionIndex","checkbox","selectedRows","dataSelect"],[3,"overPanel","functionIndex","singleSelect","selectedRow","dataSelect"]],template:function(e,t){if(1&e){var n=Y.Zb();Y.Yb(0,"div",0),Y.Tb(1,"div",1),Y.Yb(2,"div",2),Y.Yb(3,"div",3),Y.Sc(4,Ie,3,3,"h2",4),Y.Sc(5,Ne,3,3,"h2",4),Y.Yb(6,"div",5),Y.Yb(7,"button",6),Y.gc("click",(function(){return t.save()})),Y.Tb(8,"span",7),Y.Yb(9,"span"),Y.Uc(10),Y.lc(11,"translate"),Y.Xb(),Y.Xb(),Y.Yb(12,"button",6),Y.gc("click",(function(){return t.cancel()})),Y.Tb(13,"span",8),Y.Yb(14,"span"),Y.Uc(15),Y.lc(16,"translate"),Y.Xb(),Y.Xb(),Y.Xb(),Y.Xb(),Y.Yb(17,"div",9),Y.Yb(18,"div",10),Y.Yb(19,"div",11),Y.Yb(20,"div",12),Y.Yb(21,"span"),Y.Uc(22),Y.lc(23,"translate"),Y.Xb(),Y.Yb(24,"button",13),Y.gc("click",(function(){Y.Jc(n);var e=Y.Fc(118);return t.showTips(e)})),Y.lc(25,"translate"),Y.Yb(26,"mat-icon"),Y.Uc(27,"help_outline"),Y.Xb(),Y.Xb(),Y.Xb(),Y.Yb(28,"div",14),Y.Sc(29,Le,15,12,"div",15),Y.Xb(),Y.Xb(),Y.Tb(30,"mat-divider",16),Y.Yb(31,"div",17),Y.Yb(32,"span"),Y.Uc(33),Y.lc(34,"translate"),Y.Xb(),Y.Yb(35,"div",14),Y.Sc(36,Ze,15,12,"div",18),Y.Xb(),Y.Xb(),Y.Tb(37,"mat-divider",16),Y.Yb(38,"div",17),Y.Yb(39,"span"),Y.Uc(40),Y.lc(41,"translate"),Y.Xb(),Y.Yb(42,"div",14),Y.Sc(43,Xe,15,12,"div",19),Y.Xb(),Y.Xb(),Y.Xb(),Y.Yb(44,"div",20),Y.Yb(45,"div",21),Y.Yb(46,"button",22),Y.gc("click",(function(){return Y.Jc(n),Y.Fc(51).click()})),Y.lc(47,"translate"),Y.Yb(48,"mat-icon"),Y.Uc(49,"folder_open"),Y.Xb(),Y.Xb(),Y.Yb(50,"input",23,24),Y.gc("change",(function(e){return t.loadFromJson(e)})),Y.Xb(),Y.Sc(52,Je,9,6,"ng-container",25),Y.Sc(53,je,2,2,"span",26),Y.Xb(),Y.Yb(54,"div",27),Y.Yb(55,"button",22),Y.gc("click",(function(){return t.setFullScreen()})),Y.lc(56,"translate"),Y.Sc(57,Qe,2,0,"mat-icon",25),Y.Sc(58,Be,2,0,"mat-icon",25),Y.Xb(),Y.Sc(59,Ve,4,3,"button",28),Y.Sc(60,Pe,5,3,"ng-container",25),Y.Yb(61,"button",22),Y.gc("click",(function(){return t.propertyOpenOrFold()})),Y.lc(62,"translate"),Y.Yb(63,"mat-icon"),Y.Uc(64,"menu"),Y.Xb(),Y.Xb(),Y.Xb(),Y.jc(),Y.Yb(65,"svg",29),Y.gc("dragover",(function(e){return t.onDragOver(e)}))("drop",(function(e){return t.onControlDrop(e)})),Y.Yb(66,"style",30),Y.Uc(67," rect { fill: transparent } path { stroke: black } "),Y.Xb(),Y.Tb(68,"defs",31),Y.Yb(69,"defs"),Y.Yb(70,"marker",32),Y.Tb(71,"circle",33),Y.Xb(),Y.Yb(72,"marker",34),Y.Tb(73,"path",35),Y.Xb(),Y.Xb(),Y.Yb(74,"g"),Y.Tb(75,"g",36),Y.Tb(76,"g",37),Y.Xb(),Y.Xb(),Y.Xb(),Y.ic(),Y.Yb(77,"div",38),Y.gc("click",(function(){return t.onPanelClick()})),Y.Yb(78,"form",39),Y.Yb(79,"mat-form-field",40),Y.Yb(80,"mat-label"),Y.Uc(81),Y.lc(82,"translate"),Y.Xb(),Y.Tb(83,"input",41),Y.Sc(84,Oe,4,6,"mat-error",25),Y.Xb(),Y.Yb(85,"lib-ng-material-flatpickr",42,43),Y.gc("sourceDate",(function(e){Y.Jc(n);var i=Y.Fc(91);return t.onStartSourceDate(e,i)})),Y.lc(87,"translate"),Y.lc(88,"translate"),Y.lc(89,"translate"),Y.Xb(),Y.Yb(90,"lib-ng-material-flatpickr",42,44),Y.gc("sourceDate",(function(e){Y.Jc(n);var i=Y.Fc(86);return t.onEndSourceDate(e,i)})),Y.lc(92,"translate"),Y.lc(93,"translate"),Y.lc(94,"translate"),Y.Xb(),Y.Yb(95,"mat-form-field",40),Y.Yb(96,"mat-label"),Y.Uc(97),Y.lc(98,"translate"),Y.Xb(),Y.Yb(99,"input",45),Y.gc("focus",(function(){Y.Jc(n);var e=Y.Fc(126);return t.openActivity(e)})),Y.Xb(),Y.Xb(),Y.Yb(100,"mat-slide-toggle",46),Y.Uc(101),Y.lc(102,"translate"),Y.Xb(),Y.Yb(103,"mat-form-field",47),Y.Yb(104,"mat-label"),Y.Uc(105),Y.lc(106,"translate"),Y.Xb(),Y.Tb(107,"textarea",48,49),Y.Xb(),Y.Xb(),Y.Xb(),Y.Sc(109,et,11,13,"div",50),Y.Sc(110,tt,7,8,"div",51),Y.Sc(111,at,3,6,"div",52),Y.Sc(112,bt,16,12,"div",53),Y.Xb(),Y.Xb(),Y.Xb(),Y.Sc(113,At,2,3,"ng-template",null,54,Y.Tc),Y.Sc(115,yt,2,3,"ng-template",null,55,Y.Tc),Y.Sc(117,wt,6,4,"ng-template",null,56,Y.Tc),Y.Sc(119,kt,1,4,"ng-template",null,57,Y.Tc),Y.Sc(121,Et,1,4,"ng-template",null,58,Y.Tc),Y.Sc(123,Gt,1,4,"ng-template",null,59,Y.Tc),Y.Sc(125,Tt,1,4,"ng-template",null,60,Y.Tc)}2&e&&(Y.Gb(4),Y.sc("ngIf",t.isReload),Y.Gb(1),Y.sc("ngIf",!t.isReload),Y.Gb(2),Y.sc("disableRipple",!0)("matRippleRadius",15)("matRippleColor","#000000"),Y.Gb(3),Y.Vc(Y.mc(11,52,"strategy.save")),Y.Gb(2),Y.sc("disableRipple",!0)("matRippleRadius",15)("matRippleColor","#000000"),Y.Gb(3),Y.Vc(Y.mc(16,54,"strategy.cancel")),Y.Gb(3),Y.sc("@animate",Y.vc(91,rt,Y.uc(90,It))),Y.Gb(4),Y.Vc(Y.mc(23,56,"strategy.trigger")),Y.Gb(2),Y.sc("matTooltip",Y.mc(25,58,"strategy.shortCuts")),Y.Gb(5),Y.sc("ngForOf",t.triggers),Y.Gb(4),Y.Vc(Y.mc(34,60,"strategy.control")),Y.Gb(3),Y.sc("ngForOf",t.controls),Y.Gb(4),Y.Vc(Y.mc(41,62,"strategy.actuator")),Y.Gb(3),Y.sc("ngForOf",t.actuators),Y.Gb(2),Y.sc("@animate",Y.vc(94,rt,Y.uc(93,Nt))),Y.Gb(1),Y.sc("matTooltip",Y.mc(47,64,"strategy.loadJson")),Y.Gb(6),Y.sc("ngIf",t.nodes.length>0),Y.Gb(1),Y.sc("ngIf",t.errorMsg),Y.Gb(1),Y.sc("@animate",Y.vc(97,rt,Y.uc(96,Yt)))("ngStyle.lt-md",Y.uc(99,Ct))("ngClass",Y.vc(100,Lt,t.propertyOpenFold)),Y.Gb(1),Y.sc("matTooltip",Y.mc(56,66,"strategy.fullscreen")),Y.Gb(2),Y.sc("ngIf",!t.isFullScreen),Y.Gb(1),Y.sc("ngIf",t.isFullScreen),Y.Gb(1),Y.sc("ngIf",t.isReload),Y.Gb(1),Y.sc("ngIf",t.nodes.length>0),Y.Gb(1),Y.sc("matTooltip",Y.mc(62,68,"strategy.fold")),Y.Gb(4),Y.sc("@animate",Y.vc(103,rt,Y.uc(102,Ut))),Y.Gb(12),Y.sc("ngStyle",Y.vc(105,Rt,t.propertyOpenFold?"translateX(100%)":"translateX(0px)")),Y.Gb(1),Y.sc("formGroup",t.strategy),Y.Gb(3),Y.Vc(Y.mc(82,70,"strategy.name")),Y.Gb(3),Y.sc("ngIf",t.strategy.get("name").invalid),Y.Gb(1),Y.sc("timeControl",t.strategy.get("beginDate"))("config",t.config)("requiredMsg",Y.mc(87,72,"strategy.startTime")+Y.mc(88,74,"form.required"))("label",Y.mc(89,76,"strategy.startTime")),Y.Gb(5),Y.sc("timeControl",t.strategy.get("endDate"))("config",t.config)("requiredMsg",Y.mc(92,78,"strategy.endTime")+Y.mc(93,80,"form.required"))("label",Y.mc(94,82,"strategy.endTime")),Y.Gb(7),Y.Vc(Y.mc(98,84,"strategy.selectActivity")),Y.Gb(2),Y.sc("value",t.currentActivity?t.currentActivity.name:""),Y.Gb(2),Y.Wc(" ",Y.mc(102,86,"strategy.enabled")," "),Y.Gb(4),Y.Vc(Y.mc(106,88,"strategy.strategyDesc")),Y.Gb(4),Y.sc("ngIf",t.selectElement&&t.showEditControls),Y.Gb(1),Y.sc("ngIf",t.selectElement&&t.showInput),Y.Gb(1),Y.sc("ngIf",t.selectElement&&t.showChangeType),Y.Gb(1),Y.sc("ngIf",t.selectElement&&t.showEditPanel))},directives:[N.c,V.d,V.c,P.n,V.e,O.b,W.q,N.e,z.a,H.a,P.m,K.a,V.a,q.c,P.l,q.a,P.o,A.v,A.p,A.i,_.c,_.f,$.b,A.c,A.o,A.g,pe,fe.a,be.b,_.b,P.p,P.q,V.f,Ae.b,Ae.a,Ae.c,ye.a,ve.a,we.a,ke.a,Ee.a],pipes:[D.c],styles:[".content-card[_ngcontent-%COMP%], .content-card[_ngcontent-%COMP%]   .node-div[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.content-card[_ngcontent-%COMP%]   .node-div[_ngcontent-%COMP%]{cursor:pointer;margin:0 6px}.content-card[_ngcontent-%COMP%]   .node-div[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{border:1px solid transparent}.content-card[_ngcontent-%COMP%]   .node-div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:50px;height:50px;padding:2.5px}.content-card[_ngcontent-%COMP%]   .node-div[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-size:10px!important}.content-card[_ngcontent-%COMP%]   #control-panel[_ngcontent-%COMP%]{overflow:auto}.content-card[_ngcontent-%COMP%]   #control-panel[_ngcontent-%COMP%]   .node-div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:8px}.content-card[_ngcontent-%COMP%]   .canvas-left-buttons[_ngcontent-%COMP%]{position:absolute;left:278px;transition:left .3s ease-in-out 0s;top:64px}.content-card[_ngcontent-%COMP%]   .canvas-left-buttons[_ngcontent-%COMP%]   .error-span[_ngcontent-%COMP%]{border-left:1px solid rgba(0,0,0,.12);padding:0 8px;max-width:350px;overflow:auto;font-weight:600;color:#f44336}.content-card[_ngcontent-%COMP%]   .canvas-right-buttons[_ngcontent-%COMP%]{position:absolute;right:278px;transition:right .3s ease-in-out 0s;top:64px}.content-card[_ngcontent-%COMP%]   .canvas-right[_ngcontent-%COMP%]{right:24px}.content-card[_ngcontent-%COMP%]   .select-activity[_ngcontent-%COMP%]{cursor:pointer}"],data:{animation:N.t}}),St),Dt=function t(){e(this,t)},Ft=function t(){e(this,t),this.params={}},Xt=function t(){e(this,t)},Jt=function t(){e(this,t)},jt=function t(){e(this,t),this.params={},this.center=new Qt},Qt=function t(){e(this,t)},Bt=((Mt=function(){function t(){e(this,t)}return n(t,[{key:"canDeactivate",value:function(e,t,n,i){if(e&&e.nodes.length>0&&!e.finished&&!e.isReload){var a=e.dialog.open(e.canLeave,{id:"canLeave"}).afterClosed();return a.subscribe((function(e){})),a}return!0}}]),t}()).\u0275fac=function(e){return new(e||Mt)},Mt.\u0275prov=Y.Ob({token:Mt,factory:Mt.\u0275fac}),Mt),Vt=a("d3UM"),Pt=a("GpJN"),Ot=a("dAsI"),Wt=a("o+yB"),zt=a("4ly5"),Ht=a("iFSc"),Kt=((xt=function t(){e(this,t)}).\u0275mod=Y.Qb({type:xt}),xt.\u0275inj=Y.Pb({factory:function(e){return new(e||xt)},providers:[Bt],imports:[[c.a,_.e,$.c,W.r,Vt.b,Ae.d,N.j,fe.b,be.c,me,Z.l.forChild([{path:"",component:Zt}]),Pt.a,Ot.a,Wt.a,zt.a,Ht.a.forChild(B.a,["searchTags","searchCoupons","searchMessages","searchActivities"])]]}),xt)}}])}();